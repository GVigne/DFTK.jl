<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating supercells with pymatgen · DFTK.jl</title><link rel="canonical" href="https://docs.dftk.org/stable/examples/pymatgen/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DFTK.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../guide/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Introduction to periodic problems</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Density-functional theory</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li class="is-active"><a class="tocitem" href>Creating supercells with pymatgen</a></li><li><a class="tocitem" href="../ase/">Creating slabs with ASE</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Advanced topics</span><ul><li><a class="tocitem" href="../../advanced/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../advanced/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../advanced/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../advanced/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/pymatgen.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Creating-supercells-with-pymatgen"><a class="docs-heading-anchor" href="#Creating-supercells-with-pymatgen">Creating supercells with pymatgen</a><a id="Creating-supercells-with-pymatgen-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-supercells-with-pymatgen" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/pymatgen.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/pymatgen.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>The <a href="https://pymatgen.org/">Pymatgen</a> python library allows to setup solid-state calculations using a flexible set of classes as well as an API to an online data base of structures. Its <code>Structure</code> and <code>Lattice</code> objects are directly supported by the DFTK <code>load_atoms</code> and <code>load_lattice</code> functions, such that DFTK may be readily used to run calculation on systems defined in pymatgen. Using the <code>pymatgen_structure</code> function a conversion from DFTK to pymatgen structures is also possible. In the following we use this to create a silicon supercell and find its LDA ground state using direct minimisation. To run this example Julia&#39;s <code>PyCall</code> package needs to be able to find an installation of <code>pymatgen</code>.</p><p>First we setup the silicon lattice in DFTK.</p><pre><code class="language-julia">using DFTK

a = 10.263141334305942  # Lattice constant in Bohr
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8];</code></pre><p>Next we make a <code>[2, 2, 2]</code> supercell using pymatgen</p><pre><code class="language-julia">pystruct = pymatgen_structure(lattice, atoms, positions)
pystruct.make_supercell([2, 2, 2])
lattice   = load_lattice(pystruct)
positions = load_positions(pystruct)
atoms     = fill(Si, length(positions));</code></pre><p>Setup an LDA model and discretize using a single k-point and a small <code>Ecut</code> of 5 Hartree.</p><pre><code class="language-julia">model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=(1, 1, 1))</code></pre><pre class="documenter-example-output">PlaneWaveBasis discretization:
    Ecut                 : 5.0 Ha
    fft_size             : (32, 32, 32), 32768 total points
    kgrid type           : Monkhorst-Pack
    kgrid                : [1, 1, 1]
    num. irred. kpoints  : 1

    Discretized Model(lda_xc_teter93, 3D):
        lattice (in Bohr)    : [0         , 10.2631   , 10.2631   ]
                               [10.2631   , 0         , 10.2631   ]
                               [10.2631   , 10.2631   , 0         ]
        unit cell volume     : 2162.1 Bohr³
    
        atoms                : Si₁₆
        atom potentials      : ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
    
        num. electrons       : 64
        spin polarization    : none
        temperature          : 0 Ha
    
        terms                : Kinetic()
                               AtomicLocal()
                               AtomicNonlocal()
                               Ewald()
                               PspCorrection()
                               Hartree()
                               Xc(:lda_xc_teter93)</pre><p>Find the ground state using direct minimisation and newton (always using SCF is boring ...)</p><pre><code class="language-julia">scfres = direct_minimization(basis; tol=1e-3);
ψ, _ = DFTK.select_occupied_orbitals(basis, scfres.ψ, scfres.occupation)
scfres_newton = newton(basis, ψ; tol=1e-12)</code></pre><pre class="documenter-example-output">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3000838204844399 -0.38651676076137903 … -0.6442304016759204 -0.38651676076137265; -0.38651676076137914 -0.768132121776889 … -0.2500340648365427 -0.24218268965121173; … ; -0.6442304016759205 -0.25003406483654256 … -3.0211542861086325 -1.4664153489044962; -0.3865167607613723 -0.24218268965121167 … -1.466415348904496 -0.7681321217768756;;; -0.3865167607613794 -0.7681321217768898 … -0.25003406483654234 -0.24218268965121173; -0.7681321217768898 -1.8161936706060218 … -0.13699557143111138 -0.312988420493962; … ; -0.25003406483654256 -0.1369955714311113 … -0.9870510298301364 -0.5277759153846058; -0.24218268965121126 -0.3129884204939619 … -0.5277759153846058 -0.3129884204939551;;; -0.6442304016759322 -1.4664153489045144 … -0.08831357031438808 -0.25003406483654783; -1.4664153489045144 -4.114878101698644 … -0.14040892324045914 -0.5277759153846148; … ; -0.08831357031438869 -0.14040892324045884 … -0.26983750242606713 -0.14040892324045487; -0.2500340648365478 -0.5277759153846147 … -0.14040892324045426 -0.1369955714311098;;; … ;;; -0.9859863776629684 -0.35824744851609447 … -4.090627806711926 -2.29024663594557; -0.3582474485160943 -0.08635610801077073 … -1.4293432742461814 -0.8160371791714962; … ; -4.090627806711926 -1.4293432742461816 … -8.358403967979397 -8.33163370910521; -2.29024663594557 -0.8160371791714959 … -8.33163370910521 -5.7704684544717795;;; -0.6442304016759217 -0.25003406483654367 … -3.021154286108632 -1.466415348904497; -0.25003406483654367 -0.13699557143111163 … -0.9870510298301353 -0.5277759153846068; … ; -3.021154286108632 -0.9870510298301354 … -12.395558685839045 -8.358412346516113; -1.4664153489044969 -0.5277759153846068 … -8.358412346516113 -4.114878101698615;;; -0.3865167607613733 -0.24218268965121195 … -1.4664153489044964 -0.7681321217768768; -0.24218268965121206 -0.31298842049396153 … -0.5277759153846063 -0.3129884204939567; … ; -1.4664153489044964 -0.5277759153846062 … -8.358412346516115 -4.114878101698615; -0.7681321217768764 -0.3129884204939567 … -4.114878101698615 -1.8161936706059967]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.4146441233278865 0.39657304147651345 … 0.35144655171223765 0.3965730414746163; 0.3965730414763656 0.3788396749679627 … 0.3293847149112155 0.37721024005391224; … ; 0.35144655171133915 0.32938471491055404 … 0.3054493552632502 0.3368384537641305; 0.3965730414743717 0.3772102400538745 … 0.3368384537647565 0.3788396749644971;;; 0.3965730414767442 0.37883967496844706 … 0.32938471491119276 0.37721024005413123; 0.3788396749681507 0.3561971032755831 … 0.3080895619548873 0.3612452515414912; … ; 0.32938471491037624 0.3080895619544395 … 0.2924553591438596 0.32127371786050923; 0.37721024005394127 0.3612452515416588 … 0.3212737178611028 0.36124525153929854;;; 0.3514465517151187 0.3368384537686289 … 0.2761789444781271 0.329384714912678; 0.3368384537680874 0.3170055081973224 … 0.26527682063524616 0.3212737178641119; … ; 0.27617894447758173 0.26527682063530417 … 0.23776881427761892 0.2652768206327624; 0.32938471491266086 0.321273717864699 … 0.2652768206332531 0.3080895619542892;;; … ;;; 0.3042276884469829 0.2747055006102542 … 0.2896947418474759 0.30197446520846205; 0.27470550061000976 0.2424398389002539 … 0.2670218501569068 0.27930067583200124; … ; 0.2896947418464904 0.2670218501563197 … 0.29254993745280794 0.29254993745250385; 0.3019744652083015 0.27930067583215507 … 0.29254993745330576 0.29803211428786036;;; 0.3514465517101178 0.3293847149089565 … 0.3054493552628008 0.3368384537633742; 0.3293847149087739 0.30808956195226644 … 0.2924553591436566 0.32127371785962355; … ; 0.3054493552619053 0.29245535914308324 … 0.2834572356334236 0.29254993745406926; 0.3368384537632068 0.32127371785970266 … 0.2925499374547803 0.31700550819305273;;; 0.39657304147381467 0.3772102400530788 … 0.3368384537648024 0.3788396749642429; 0.3772102400529519 0.36124525154029113 … 0.3212737178612026 0.36124525153881115; … ; 0.336838453763919 0.32127371786055914 … 0.2925499374553845 0.31700550819361256; 0.37883967496403065 0.361245251538785 … 0.3170055081942624 0.3561971032710059]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.5107819307696028 -0.501977009903204 … -0.47611237437643833 -0.5019770099025644; -0.5019770099031735 -0.48535993054999205 … -0.4759501925062565 -0.4961273962001913; … ; -0.4761123743760667 -0.47595019250595466 … -0.3886650109546198 -0.44477647369301; -0.5019770099024427 -0.4961273962001218 … -0.4447764736932729 -0.4853599305487355;;; -0.5019770099032898 -0.48535993055028104 … -0.47595019250600346 -0.496127396200172; -0.4853599305502282 -0.4471770870274171 … -0.4685944734834855 -0.48843627177709514; … ; -0.475950192505461 -0.46859447348301736 … -0.4356487530318598 -0.4656167511937779; -0.49612739619997426 -0.48843627177698185 … -0.46561675119410856 -0.48843627177589766;;; -0.4761123743774337 -0.44477647369511486 … -0.4556962499539431 -0.47595019250660975; -0.44477647369489337 -0.3801453746930018 … -0.45086201699068584 -0.4656167511959006; … ; -0.45569624995337465 -0.4508620169903481 … -0.435860649747401 -0.4508620169888089; -0.4759501925064454 -0.4656167511959781 … -0.45086201698918527 -0.4685944734827984;;; … ;;; -0.44169616564135306 -0.44940904901402756 … -0.35414084470551227 -0.40189398445664837; -0.44940904901369094 -0.4412016607933791 … -0.40365274214716335 -0.4350655492733292; … ; -0.35414084470553664 -0.40365274214779345 … -0.2945401508762651 -0.29454015087745156; -0.4018939844569176 -0.4350655492739649 … -0.29454015087795843 -0.33722098421358904;;; -0.4761123743757615 -0.47595019250536874 … -0.3886650109562071 -0.4447764736933485; -0.47595019250514004 -0.46859447348219463 … -0.4356487530334078 -0.46561675119416135; … ; -0.38866501095616307 -0.43564875303377226 … -0.2118115941820341 -0.29454015087899454; -0.44477647369349715 -0.4656167511945638 … -0.2945401508794665 -0.3801453746920942;;; -0.5019770099023481 -0.496127396199848 … -0.4447764736939581 -0.4853599305489159; -0.4961273961997393 -0.48843627177637294 … -0.4656167511949627 -0.48843627177608; … ; -0.4447764736937837 -0.4656167511949887 … -0.2945401508782132 -0.38014537469187093; -0.48535993054892645 -0.4884362717762214 … -0.38014537469213583 -0.4471770870260082])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3962216279261561 -0.4919207291880696 … -0.7688962243401211 -0.4919207291893208; -0.4919207291881871 -0.8746523773589183 … -0.3965995424315837 -0.36109984579749077; … ; -0.7688962243406481 -0.3965995424319432 … -3.104369941800002 -1.5743533688333757; -0.49192072918944324 -0.361099845797459 … -1.5743533688330122 -0.874652377361114;;; -0.49192072918792495 -0.8746523773587238 … -0.39659954243135304 -0.3610998457972525; -0.8746523773589674 -1.9071736543578557 … -0.29750048295970954 -0.440179440729566; … ; -0.3965995424316273 -0.29750048295968917 … -1.1302444237181366 -0.6721189487178745; -0.36109984579724425 -0.44017944072928494 … -0.6721189487176116 -0.4401794407305542;;; -0.7688962243382471 -1.5743533688310003 … -0.2678308757902041 -0.39659954243047957; -1.5743533688313203 -4.1780179681943235 … -0.32599411959589886 -0.6721189487164034; … ; -0.2678308757901816 -0.3259941195955028 … -0.46792933789584923 -0.3259941195965014; -0.3965995424303323 -0.6721189487158938 … -0.32599411959638647 -0.297500482959619;;; … ;;; -1.1234548548573384 -0.5329509969198678 … -4.155073909569962 -2.3901661551937567; -0.5329509969197754 -0.28511792990389595 … -1.565974166236438 -0.9718020526128242; … ; -4.155073909570972 -1.5659741662376554 … -8.360394181402855 -8.333623922530158; -2.390166155194186 -0.9718020526133057 … -8.333623922529863 -5.8096573243975085;;; -0.7688962243415653 -0.3965995424329559 … -3.1043699418020383 -1.5743533688344713; -0.3965995424329098 -0.2975004829610398 … -1.1302444237198865 -0.6721189487191446; … ; -3.1043699418028896 -1.1302444237208245 … -12.323913044387655 -8.360402559941038; -1.5743533688347873 -0.6721189487194679 … -8.3604025599408 -4.178017968197656;;; -0.4919207291899067 -0.36109984579798116 … -1.5743533688336522 -0.8746523773615498; -0.3610998457979995 -0.44017944073004334 … -0.6721189487183664 -0.44017944073122556; … ; -1.5743533688343612 -0.6721189487190358 … -8.360402559938944 -4.178017968196873; -0.8746523773617723 -0.4401794407313931 … -4.178017968196489 -1.907173654360999]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[3.9809008764608855e-7 + 5.060850993465673e-7im -1.0072294792898376e-5 - 3.848107589948884e-5im … -0.14039001991509883 + 0.005580798980114114im -6.6336284271310625e-6 + 3.1495746890236245e-5im; -4.329450679879127e-5 + 1.2627349332857759e-5im 1.291464363016296e-5 + 1.021066324122932e-6im … -8.151714669676181e-6 - 9.950057132215665e-7im 1.6830728460620526e-5 - 2.778988217647117e-5im; … ; 0.03824847490871386 + 0.11710600073334719im -9.238106008504352e-6 + 2.462364730275353e-5im … -0.11933840291710543 + 0.14334146393945074im -9.636304939867832e-6 + 0.00012958931656775193im; 3.659201432389395e-5 - 1.3814778035379287e-5im -1.0698376679732893e-5 + 1.1362701723717393e-5im … 6.57422141928531e-5 - 2.8509157466793844e-5im -7.290948021686725e-6 - 1.608564993020727e-5im;;; -4.009345724710149e-6 + 5.881710077193959e-6im -5.873291554091132e-7 + 1.6481824065245624e-5im … -1.2050065278320484e-5 + 8.949977897098191e-6im -7.3422172056560925e-6 + 2.1192882424655366e-6im; 5.839553225443017e-5 - 2.8710020536215758e-5im 2.1892805799894085e-8 + 2.1616511603342293e-6im … 2.8023841909881806e-5 - 1.4904869404804507e-5im 7.0284357911800346e-6 + 8.754238603265578e-6im; … ; -1.1110990821762156e-6 + 2.3750899903412355e-5im -1.6421305751409155e-6 + 8.821455257294508e-6im … -1.3294480238611665e-5 + 3.970010846384308e-5im -6.90238603336228e-6 + 7.681630210338072e-6im; 9.143731033931938e-6 - 2.1376914551149655e-5im -4.0994912374254254e-6 + 7.297199008302259e-6im … -3.575123445837024e-5 - 8.917461784273017e-6im 2.9587006619315896e-6 + 1.3518224119899424e-5im;;; 0.062029133500740526 + 0.019813934735507632im 4.025130500840426e-6 - 3.642408378459611e-5im … -0.022664246866064032 + 0.007344925662639584im -6.943138350234194e-8 + 1.3921384097398318e-5im; -5.603028690849951e-5 + 1.7851031235763425e-5im 1.4848630373905382e-5 + 3.023542071664777e-6im … -2.3821886863540764e-5 + 7.649418324301418e-6im 1.5667551962915343e-5 - 1.563831280571027e-5im; … ; 0.02900324338966432 + 0.039601283848386876im 4.569139392331854e-7 - 2.0360443182439987e-5im … -0.06080980830328604 + 0.05583652049027524im -5.9265632930640305e-6 + 4.963047636094384e-5im; 9.73285374556393e-6 - 4.224877761085391e-6im -1.3692139543126462e-6 + 8.5917984627336e-6im … 2.5580078603924255e-5 - 1.1427868443903044e-5im -1.6553767648519663e-6 - 8.632952364651406e-6im;;; … ;;; -7.033906119158345e-7 - 2.1921112578858934e-7im -7.086704361751878e-7 - 1.1108551736764258e-6im … -1.4394675848573813e-5 + 8.078858073916796e-6im -4.025428493353004e-6 - 7.098121957919265e-6im; 2.5420107038731103e-5 + 5.872216314888757e-6im -3.163385260639146e-6 - 8.834438736891486e-6im … -2.3895014289265545e-5 + 1.1979978235884258e-6im 9.527122047253376e-7 - 1.9725953613306897e-6im; … ; 1.9717028294448038e-6 + 3.0223314326665592e-5im -2.7556741499213583e-6 + 4.769276420254272e-6im … -7.203306184829234e-6 + 2.509130187479374e-5im -3.897879944060294e-6 + 4.953904854616151e-6im; -6.711779657400718e-6 + 5.399296794121782e-6im -3.390460706373448e-6 - 2.5412621437268226e-6im … -5.985312031103996e-5 + 1.9037751013890902e-7im 1.213044285790428e-6 + 5.5530509727783655e-6im;;; 0.06202913350391604 + 0.019813934703853828im -1.3374938587833059e-6 - 1.1883680525717309e-5im … -0.09155407921692263 + 0.029669496222407374im 8.145394879024423e-6 + 4.742324330660694e-5im; -1.972657035333029e-5 + 5.526066983640521e-6im 5.941115055524031e-6 - 2.201489146289878e-6im … 2.1206787507926383e-5 - 1.1279480179963142e-5im 8.192646368150791e-6 - 2.1966794663692318e-5im; … ; 0.11715964272294216 + 0.1599708625165917im 2.2133086825340956e-7 + 7.50783915404052e-5im … -0.040113280145865696 + 0.14249963016061493im 5.291503274249019e-6 + 0.0001387862793194628im; 3.9690997284757544e-5 - 1.3832347602369334e-5im -8.844115660936598e-6 + 2.2633199247928506e-6im … 6.112024224469956e-5 - 2.587130342486224e-5im -7.184569355004128e-6 - 1.5630475023111393e-5im;;; -2.750387550304316e-6 + 2.3286353971264e-6im -1.5139835097974462e-6 + 5.92099306266918e-6im … -2.2741131676111568e-5 + 1.2771517836380064e-5im -7.5342769301303185e-6 - 9.108472109202924e-6im; 6.189974525533708e-5 - 5.469678196363782e-6im -3.867233445830118e-6 - 9.314811728686359e-6im … -3.1024554529425945e-6 + 9.269504782998284e-7im 3.190952917285986e-6 - 3.093795375813773e-6im; … ; 1.8789050458676966e-6 + 4.608355034321214e-5im -3.2955066327565753e-6 + 1.0034366188449236e-5im … -1.8038509962626048e-5 + 5.663795395596131e-5im -7.523054150670314e-6 + 5.805642636657038e-6im; 6.755086425484886e-6 + 4.090268101680364e-6im -7.936970054427329e-6 - 4.550825367705172e-6im … -6.35848181928529e-5 + 8.982670971803718e-6im -7.801266917081592e-7 + 1.3464123112246507e-6im]],))]), basis = PlaneWaveBasis(model = Model(lda_xc_teter93, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -62.261666463645696), converged = true, ρ = [0.0960868674444803 0.09083571641136459 … 0.07654262057166193 0.09083571641099038; 0.09083571641134668 0.08146267958596763 … 0.07645818443434181 0.08745698068880117; … ; 0.07654262057146831 0.0764581844341848 … 0.03956106920998331 0.06137480408795593; 0.09083571641091907 0.08745698068876154 … 0.06137480408807372 0.0814626795852849;;; 0.09083571641141468 0.08146267958612471 … 0.07645818443421024 0.08745698068879015; 0.08146267958609597 0.062457200764180425 … 0.07269477761831192 0.08314585281682693; … ; 0.07645818443392789 0.07269477761807644 … 0.05737574130799715 0.0712077940346588; 0.08745698068867754 0.08314585281676454 … 0.0712077940348228 0.08314585281616724;;; 0.07654262057218031 0.06137480408889929 … 0.06640311616602208 0.07645818443452577; 0.061374804088800174 0.036798277195939116 … 0.06414382459835849 0.07120779403571142; … ; 0.06640311616575344 0.06414382459820243 … 0.05746650749672274 0.06414382459749163; 0.07645818443444025 0.07120779403574977 … 0.06414382459766539 0.07269477761796633;;; … ;;; 0.060004730093287384 0.0634751372164922 … 0.029183307259774947 0.04412623324593191; 0.06347513721633777 0.05978673871978837 … 0.04475896535859254 0.057126429234054636; … ; 0.029183307259781573 0.044758965358820346 … 0.015923490008255246 0.015923490008466774; 0.04412623324602828 0.057126429234325905 … 0.015923490008557147 0.024854804932649594;;; 0.07654262057130937 0.07645818443387986 … 0.03956106921051076 0.06137480408810764; 0.07645818443376078 0.0726947776176627 … 0.05737574130865991 0.07120779403484902; … ; 0.0395610692104962 0.057375741308815925 … 0.0053374781539185815 0.01592349000874188; 0.06137480408817427 0.07120779403504847 … 0.015923490008826046 0.03679827719565207;;; 0.0908357164108638 0.08745698068860552 … 0.061374804088380926 0.08146267958538286; 0.08745698068854342 0.08314585281642907 … 0.0712077940352463 0.08314585281626775; … ; 0.061374804088302724 0.07120779403525924 … 0.015923490008602582 0.03679827719558146; 0.08146267958538868 0.08314585281634548 … 0.03679827719566519 0.062457200763541366;;;;], eigenvalues = Any[[-0.16182021998801355, -0.07474945091989917, -0.07474945091912313, -0.07474945091768954, -0.07474945091638134, -0.009793159971749461, -0.009793159971581747, -0.009793159971081867, -0.009793159970770977, -0.009793159969894187  …  0.2247496375860604, 0.22474963758672434, 0.22474963758743186, 0.22474963758818015, 0.224749637588792, 0.22474963758907243, 0.2247496375894845, 0.27099404400617616, 0.270994044006348, 0.2709940440064631]], occupation = [[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0  …  2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]], εF = nothing, n_iter = 4, ψ = Matrix{ComplexF64}[[-0.591691187380566 - 0.7522084900040766im -2.441976428745949e-12 - 2.519932705743356e-12im … 1.8157384485573587e-12 + 3.5730022704097186e-12im -2.879706605698731e-12 - 1.3397383219727213e-12im; 1.946067843622592e-12 + 9.57722562939393e-14im 0.2536344019390217 + 0.2634728220832656im … -3.062228286698429e-12 + 2.1844857957172567e-12im 1.1182471540817449e-13 - 1.911085520519759e-12im; … ; 6.128609153072584e-14 + 1.7764547790383096e-13im 5.709595127165152e-13 - 1.045852942384542e-12im … -4.168303014898253e-11 - 1.1461576508884025e-10im -1.1055105189056774e-10 + 1.961010933309139e-12im; -1.668049067469514e-12 - 6.826916910609862e-13im -0.005617557148962128 + 0.005320074806014458im … -1.416316800541002e-12 - 4.045195065079262e-12im 6.6416767698513615e-12 + 1.5543479724893297e-12im]], stage = :finalize, algorithm = &quot;Newton&quot;)</pre><pre><code class="language-julia">scfres_newton.energies</code></pre><pre class="documenter-example-output">Energy breakdown (in Ha):
    Kinetic             25.7671071
    AtomicLocal         -18.8557687
    AtomicNonlocal      14.8522650
    Ewald               -67.1831486
    PspCorrection       -2.3569765
    Hartree             4.8485375 
    Xc                  -19.3336822

    total               -62.261666463646</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metallic_systems/">« Temperature and metallic systems</a><a class="docs-footer-nextpage" href="../ase/">Creating slabs with ASE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 10 March 2022 19:29">Thursday 10 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
