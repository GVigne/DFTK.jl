<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating supercells with pymatgen · DFTK.jl</title><link rel="canonical" href="https://docs.dftk.org/stable/examples/pymatgen/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DFTK.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../guide/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Introduction to periodic problems</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Density-functional theory</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li class="is-active"><a class="tocitem" href>Creating supercells with pymatgen</a></li><li><a class="tocitem" href="../ase/">Creating slabs with ASE</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Advanced topics</span><ul><li><a class="tocitem" href="../../advanced/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../advanced/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../advanced/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../advanced/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/pymatgen.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Creating-supercells-with-pymatgen"><a class="docs-heading-anchor" href="#Creating-supercells-with-pymatgen">Creating supercells with pymatgen</a><a id="Creating-supercells-with-pymatgen-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-supercells-with-pymatgen" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/pymatgen.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/pymatgen.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>The <a href="https://pymatgen.org/">Pymatgen</a> python library allows to setup solid-state calculations using a flexible set of classes as well as an API to an online data base of structures. Its <code>Structure</code> and <code>Lattice</code> objects are directly supported by the DFTK <code>load_atoms</code> and <code>load_lattice</code> functions, such that DFTK may be readily used to run calculation on systems defined in pymatgen. Using the <code>pymatgen_structure</code> function a conversion from DFTK to pymatgen structures is also possible. In the following we use this to create a silicon supercell and find its LDA ground state using direct minimisation. To run this example Julia&#39;s <code>PyCall</code> package needs to be able to find an installation of <code>pymatgen</code>.</p><p>First we setup the silicon lattice in DFTK.</p><pre><code class="language-julia">using DFTK

a = 10.263141334305942  # Lattice constant in Bohr
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8];</code></pre><p>Next we make a <code>[2, 2, 2]</code> supercell using pymatgen</p><pre><code class="language-julia">pystruct = pymatgen_structure(lattice, atoms, positions)
pystruct.make_supercell([2, 2, 2])
lattice   = load_lattice(pystruct)
positions = load_positions(pystruct)
atoms     = fill(Si, length(positions));</code></pre><p>Setup an LDA model and discretize using a single k-point and a small <code>Ecut</code> of 5 Hartree.</p><pre><code class="language-julia">model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=(1, 1, 1))</code></pre><pre class="documenter-example-output">PlaneWaveBasis discretization:
    Ecut                 : 5.0 Ha
    fft_size             : (32, 32, 32), 32768 total points
    kgrid type           : Monkhorst-Pack
    kgrid                : [1, 1, 1]
    num. irred. kpoints  : 1

    Discretized Model(lda_x+lda_c_pw, 3D):
        lattice (in Bohr)    : [0         , 10.2631   , 10.2631   ]
                               [10.2631   , 0         , 10.2631   ]
                               [10.2631   , 10.2631   , 0         ]
        unit cell volume     : 2162.1 Bohr³
    
        atoms                : Si₁₆
        atom potentials      : ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
    
        num. electrons       : 64
        spin polarization    : none
        temperature          : 0 Ha
    
        terms                : Kinetic()
                               AtomicLocal()
                               AtomicNonlocal()
                               Ewald()
                               PspCorrection()
                               Hartree()
                               Xc([:lda_x, :lda_c_pw])</pre><p>Find the ground state using direct minimisation and newton (always using SCF is boring ...)</p><pre><code class="language-julia">scfres = direct_minimization(basis; tol=1e-3);
ψ, _ = DFTK.select_occupied_orbitals(basis, scfres.ψ, scfres.occupation)
scfres_newton = newton(basis, ψ; tol=1e-12)</code></pre><pre class="documenter-example-output">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3000838204844425 -0.3865167607613796 … -0.6442304016759225 -0.3865167607613762; -0.38651676076137836 -0.768132121776888 … -0.25003406483654445 -0.24218268965121242; … ; -0.6442304016759215 -0.25003406483654483 … -3.0211542861086316 -1.466415348904496; -0.3865167607613758 -0.24218268965121426 … -1.4664153489044964 -0.7681321217768781;;; -0.38651676076138003 -0.7681321217768898 … -0.25003406483654433 -0.24218268965121348; -0.7681321217768886 -1.8161936706060204 … -0.13699557143111202 -0.31298842049396153; … ; -0.25003406483654467 -0.13699557143111366 … -0.9870510298301364 -0.527775915384607; -0.24218268965121384 -0.3129884204939632 … -0.527775915384607 -0.31298842049395803;;; -0.6442304016759322 -1.4664153489045144 … -0.088313570314389 -0.25003406483654844; -1.466415348904513 -4.114878101698642 … -0.1404089232404591 -0.5277759153846142; … ; -0.08831357031439022 -0.14040892324046036 … -0.26983750242606713 -0.1404089232404561; -0.2500340648365487 -0.527775915384615 … -0.14040892324045487 -0.13699557143111132;;; … ;;; -0.9859863776629685 -0.3582474485160946 … -4.090627806711927 -2.290246635945571; -0.3582474485160946 -0.08635610801077073 … -1.4293432742461816 -0.8160371791714963; … ; -4.090627806711926 -1.4293432742461822 … -8.358403967979397 -8.331633709105212; -2.29024663594557 -0.8160371791714961 … -8.33163370910521 -5.7704684544717795;;; -0.6442304016759224 -0.2500340648365443 … -3.021154286108632 -1.4664153489044973; -0.2500340648365441 -0.13699557143111132 … -0.9870510298301357 -0.5277759153846076; … ; -3.021154286108632 -0.9870510298301353 … -12.395558685839045 -8.358412346516113; -1.4664153489044964 -0.5277759153846068 … -8.358412346516113 -4.114878101698613;;; -0.38651676076137653 -0.24218268965121348 … -1.4664153489044973 -0.7681321217768792; -0.24218268965121248 -0.3129884204939609 … -0.5277759153846076 -0.3129884204939583; … ; -1.4664153489044955 -0.5277759153846068 … -8.358412346516111 -4.114878101698615; -0.768132121776878 -0.3129884204939586 … -4.114878101698614 -1.816193670605997]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035007im 0.05414494805835375 - 0.0224275718197569im … 0.003755074015300082 - 0.00906555061545225im -0.003755074015300082 + 0.00906555061545225im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 7.962118806259657e-18im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.00906555061545225 + 0.003755074015300082im 0.00906555061545225 + 0.003755074015300082im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.41475374317832464 0.3966771734086096 … 0.3515373566444466 0.39667717341138425; 0.3966771734103911 0.3789391676749721 … 0.32946849925431654 0.3773084908276243; … ; 0.35153735663602165 0.3294684992445435 … 0.3055322803166599 0.3369272441489586; 0.39667717340782244 0.37730849082243834 … 0.3369272441539138 0.3789391676749754;;; 0.39667717340928493 0.378939167674689 … 0.32946849925055594 0.3773084908253086; 0.3789391676753619 0.35629277124638864 … 0.3081672339950022 0.3613386510368656; … ; 0.32946849924556976 0.3081672339896188 … 0.2925295693585555 0.321355306207971; 0.3773084908233195 0.36133865103429297 … 0.32135530621106934 0.3613386510347947;;; 0.351537356639778 0.33692724415209924 … 0.2762473057111619 0.32946849924856286; 0.33692724415207514 0.31709362589970747 … 0.26534187532525 0.3213553062111322; … ; 0.2762473057087463 0.2653418753229824 … 0.2378257613380359 0.26534187532200554; 0.329468499247687 0.32135530621032105 … 0.2653418753236133 0.3081672339912614;;; … ;;; 0.3043050825504005 0.274772836121397 … 0.28977472648457914 0.30205476272728343; 0.2747728361282844 0.24249812765571108 … 0.2670898553019009 0.27937033529681; … ; 0.28977472646518093 0.2670898552758456 … 0.2926353972826959 0.2926353972816337; 0.3020547627178041 0.27937033528064226 … 0.29263539729150173 0.2981166266595169;;; 0.35153735664240693 0.32946849924788274 … 0.3055322803299543 0.33692724415891634; 0.32946849925293353 0.30816723399322765 … 0.29252956937550806 0.32135530622004904; … ; 0.30553228031355867 0.29252956935449953 … 0.283543003675325 0.29263539728368926; 0.33692724415129377 0.3213553062076211 … 0.2926353972924405 0.31709362590191575;;; 0.396677173410433 0.3773084908237047 … 0.33692724415997655 0.3789391676792784; 0.3773084908269844 0.3613386510358389 … 0.3213553062207632 0.36133865104130214; … ; 0.3369272441475473 0.321355306205563 … 0.292635397285379 0.3170936258963464; 0.3789391676737644 0.36133865103273155 … 0.31709362590330037 0.35629277124765646]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.5113149641944996 -0.5025077544831541 … -0.4766324832592721 -0.5025077544831049; -0.5025077544834601 -0.4858848714612705 … -0.47647042401832307 -0.49665680134123513; … ; -0.4766324832577934 -0.4764704240165654 … -0.3891035353046343 -0.4452769190838642; -0.5025077544824672 -0.4966568013403073 … -0.4452769190846126 -0.4858848714605545;;; -0.5025077544834332 -0.4858848714613715 … -0.4764704240174849 -0.4966568013408997; -0.48588487146150716 -0.44768088614636414 … -0.46911089882788803 -0.48896245601920496; … ; -0.47647042401683815 -0.4691108988271296 … -0.43613878735053857 -0.4661303640504341; -0.4966568013405853 -0.48896245601876764 … -0.4661303640507346 -0.488962456018267;;; -0.4766324832593104 -0.4452769190849364 … -0.4562036919134306 -0.4764704240178785; -0.4452769190851193 -0.38057362659177485 … -0.45136507975789913 -0.4661303640517744; … ; -0.4562036919132132 -0.45136507975758905 … -0.4363491190521856 -0.4513650797570103; -0.47647042401770434 -0.46613036405147423 … -0.45136507975705503 -0.4691108988273606;;; … ;;; -0.4421917735610374 -0.44991004399486345 … -0.3545229620082809 -0.40234903540151135; -0.44991004399707335 -0.4416961440274654 … -0.40410681006799937 -0.4355541400428921; … ; -0.3545229619968184 -0.4041068100562183 … -0.29480061879334574 -0.29480061879107905; -0.40234903539689865 -0.4355541400367407 … -0.29480061879831326 -0.33757346153962314;;; -0.4766324832587855 -0.47647042401669465 … -0.38910353531064884 -0.44527691908654776; -0.47647042401793965 -0.4691108988272582 … -0.43613878735637723 -0.466130364053292; … ; -0.3891035353038586 -0.43613878734944006 … -0.21186524618894595 -0.29480061879186525; -0.44527691908400435 -0.46613036404979136 … -0.2948006187971221 -0.3805736265926702;;; -0.5025077544828465 -0.496656801340368 … -0.44527691908668265 -0.48588487146152803; -0.4966568013410202 -0.4889624560187605 … -0.46613036405340325 -0.48896245601953764; … ; -0.4452769190835323 -0.46613036404981617 … -0.2948006187921914 -0.3805736265909835; -0.4858848714602605 -0.4889624560176906 … -0.38057362659283556 -0.4476808861461583])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.39664504150061747 -0.4923473418359241 … -0.7693255282907481 -0.49234734183309686; -0.49234734183444734 -0.8750778255631865 … -0.397035989600551 -0.36153100016482326; … ; -0.7693255282976932 -0.39703598960856673 … -3.104725541096606 -1.5747650238394015; -0.4923473418360206 -0.36153100016908324 … -1.5747650238351953 -0.8750778255624572;;; -0.4923473418355283 -0.8750778255635723 … -0.3970359896034733 -0.36153100016680456; -0.8750778255630338 -1.907581785505996 … -0.2979392362639979 -0.4406122254763009; … ; -0.39703598960781306 -0.2979392362686244 … -1.1306602478221195 -0.6725509732270701; -0.3615310001684796 -0.44061222547843787 … -0.6725509732242723 -0.44061222547743034;;; -0.7693255282954645 -1.5747650238373516 … -0.26826995651665764 -0.39703598960586406; -1.5747650238375572 -4.1783581023907095 … -0.32643212767310825 -0.6725509732252564; … ; -0.2682699565188571 -0.326432127675067 … -0.46836086014021683 -0.3264321276754608; -0.39703598960656605 -0.6725509732257682 … -0.3264321276738966 -0.2979392362672105;;; … ;;; -1.1238730686736054 -0.533384656389561 … -4.155376042235629 -2.390540908619799; -0.5333846563848835 -0.28555412438252503 … -1.5663602290122802 -0.9722209839175784; … ; -4.155376042243564 -1.566360229026555 … -8.360569189490047 -8.333798930614657; -2.390540908624665 -0.9722209839275946 … -8.333798930612021 -5.809925289351886;;; -0.7693255282923009 -0.3970359896053562 … -3.1047255410893264 -1.5747650238321287; -0.39703598960155023 -0.29793923626514185 … -1.1306602478110048 -0.6725509732178505; … ; -3.104725541098932 -1.1306602478250758 … -12.323880928352667 -8.36057756802429; -1.574765023837207 -0.672550973226777 … -8.360577568020794 -4.1783581023893674;;; -0.49234734183379 -0.36153100016787676 … -1.5747650238312034 -0.8750778255591288; -0.36153100016524825 -0.4406122254768825 … -0.6725509732172477 -0.4406122254721938; … ; -1.5747650238404804 -0.6725509732288599 … -8.360577568022924 -4.178358102393252; -0.875077825563374 -0.44061222547891765 … -4.178358102388149 -1.9075817855044988]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035007im 0.05414494805835375 - 0.0224275718197569im … 0.003755074015300082 - 0.00906555061545225im -0.003755074015300082 + 0.00906555061545225im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 7.962118806259657e-18im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.00906555061545225 + 0.003755074015300082im 0.00906555061545225 + 0.003755074015300082im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[2.92312449992789e-7 + 6.620161494257787e-8im 9.884140358934072e-6 + 2.677371460901972e-7im … -0.007520724103277735 - 0.03912631147595038im -2.498335157318425e-6 + 2.562704518568262e-6im; 7.010493955521293e-6 - 1.0637163519626774e-5im -7.81894329867671e-6 + 3.063551426640097e-5im … 3.577244976703206e-6 - 5.3150203346695205e-6im -1.267886796559174e-6 + 4.3414979551566435e-5im; … ; -0.1751584790264124 - 0.06143752571164994im 1.1800262071841373e-5 + 2.7151398690230915e-6im … -0.2133713709462167 - 0.11745957615894305im 1.0625839077380721e-5 + 7.139484290067868e-6im; -8.093930964624766e-7 + 1.1122861195813046e-5im 1.271802541417135e-5 - 3.3832013230682416e-5im … -2.718170916545625e-6 + 9.866006148908973e-6im 1.8322543756237443e-5 - 2.184472857501443e-5im;;; -1.4591357126044856e-6 + 6.366241486906862e-7im 1.5986898378474943e-5 + 3.662451953885976e-6im … 1.1556296085281185e-6 + 3.6165830364185818e-6im 1.7379644010324734e-5 + 3.082923389844885e-6im; 4.18021750885832e-6 + 4.534163102758348e-6im -1.3362685402973669e-5 - 7.430000167864722e-7im … 4.004201714371371e-6 + 1.388202264467404e-6im -2.4997106284661076e-5 - 5.312003932020344e-7im; … ; 2.036764592883273e-5 + 5.126988217385266e-6im 7.453912874605224e-6 + 2.013136083547293e-6im … 3.4116123712244553e-5 + 1.25174534411383e-5im -1.277295524310055e-5 - 4.750989613626004e-6im; 1.2020330894693368e-5 - 1.6350210825480965e-5im -1.8605537816018e-5 + 7.065383060142279e-6im … 1.386616830962206e-5 - 8.28737486238855e-6im -2.756608496902431e-5 + 7.546018771007272e-6im;;; 0.09347895951679863 + 0.09144329091315022im 4.310544535562611e-6 - 9.53039908749565e-6im … 0.024854212631080258 + 0.015127077331302786im -2.1543014538745344e-6 - 2.6232010000392023e-6im; 1.3162032183246149e-5 - 1.160806059628299e-5im -1.800152672175498e-5 + 2.408748068800742e-5im … 5.703553382043957e-6 - 4.330745521292935e-6im -9.537006449550448e-6 + 3.242065087771688e-5im; … ; -0.023617025213023696 + 0.008675951974023991im 1.4264753181029677e-6 - 3.7613076731154774e-6im … -0.105495207648103 - 0.0653603765381313im 5.10452922260635e-6 + 3.583603505815145e-6im; 3.5901280943266127e-6 + 4.739218871341205e-6im -8.86584765443751e-7 - 1.5357359365852108e-5im … -9.127284103928872e-7 + 3.860330374828117e-6im 8.022852652984664e-6 - 7.370610207685385e-6im;;; … ;;; 2.924915134830236e-6 - 3.4706505233407066e-6im 4.087784232018842e-6 + 4.385625631507414e-6im … 3.000083081630755e-6 + 4.889121825192786e-6im 4.287628392049739e-6 + 2.5745426458082406e-6im; -2.1580173330870136e-6 + 6.126473378034407e-6im 2.977927885043781e-6 - 8.957838511219747e-6im … 5.810362826516441e-6 + 3.1094251506817093e-7im -4.918394477807489e-6 - 5.0359484036470585e-6im; … ; 3.173634035930959e-5 + 7.148299000922075e-6im -1.3902274698993568e-5 - 3.6220767802005533e-6im … 2.0814801873540463e-5 + 1.1036534894820721e-5im -2.3239323274164262e-5 - 8.462344549582233e-6im; 3.1276439156217612e-6 - 7.021477089439285e-6im -2.424924110791308e-6 - 2.0723832237932587e-6im … 1.0027661813808706e-5 - 6.127411568775841e-6im -1.0129462430714598e-5 + 3.2582709064334356e-6im;;; 0.0934789595114876 + 0.09144329091408833im 2.4095871652778345e-6 - 3.4690811429917476e-6im … 0.10039964158967823 + 0.06110663148722426im -1.0514817391243796e-5 - 6.782673734393491e-6im; 6.472341166260251e-6 - 3.281099529151851e-6im -1.8017489617452654e-6 + 1.2352809032984879e-5im … 4.377614052396013e-6 + 2.3889269218143348e-6im 1.272475706310893e-7 + 1.3019272365072765e-5im; … ; -0.09540280645669286 + 0.035046926925243416im 6.359207237266201e-6 - 1.775501562573001e-6im … -0.0892008811109331 - 0.009120690657393085im 3.6156376551924316e-6 - 2.5147319451839527e-6im; 3.79938366151063e-6 + 1.4444845552822584e-5im 8.777669143968195e-6 - 3.475873598202987e-5im … 2.4813368068483926e-6 + 1.1027403454899434e-5im 1.049571452353588e-5 - 3.312201205997107e-5im;;; 3.340867243923863e-6 - 4.452998668706051e-6im 1.3482939570994492e-5 + 7.860851478953e-6im … 6.602943297859481e-6 + 4.734766268604745e-6im 1.2324427494707178e-5 + 6.376644051157493e-6im; -7.016039997042562e-7 + 9.98106292083678e-6im -5.079751447787487e-6 - 1.1430930065866767e-5im … 5.99752806554225e-6 + 7.998770662011807e-6im -1.4040301933148345e-5 - 1.095029604390997e-5im; … ; 4.985379155862548e-5 + 8.135047590103407e-6im -1.5183103942902015e-5 - 1.795794650089318e-6im … 5.25875699792412e-5 + 1.7936042077666342e-5im -3.196219581942591e-5 - 7.6243699198485475e-6im; 6.202841350024305e-6 - 1.0376799650373348e-5im -7.648731365391633e-6 - 3.3537145772985033e-6im … 1.3452660097578495e-5 - 2.1583390636350364e-6im -1.390387562429175e-5 - 2.501770109794263e-6im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -62.27771586136886), converged = true, ρ = [0.09610720131708138 0.09085401337968398 … 0.07655587366969194 0.09085401337965524; 0.09085401337986304 0.08147776990996948 … 0.07647151840898408 0.08747433053425747; … ; 0.07655587366892194 0.07647151840806957 … 0.03956580495534334 0.061384247177510294; 0.09085401337928208 0.08747433053372844 … 0.061384247177845554 0.08147776990958049;;; 0.09085401337984729 0.08147776991002433 … 0.07647151840854799 0.08747433053406621; 0.08147776991009804 0.06246757364749632 … 0.0727070789334974 0.08316148815338728; … ; 0.07647151840821145 0.07270707893311605 … 0.057383084526585415 0.071219141971101; 0.08747433053388692 0.08316148815314635 … 0.07121914197124997 0.08316148815287056;;; 0.07655587366971191 0.061384247177990604 … 0.06641329348374705 0.07647151840875277; 0.06138424717807257 0.03680319832574681 … 0.06415300528659394 0.07121914197176539; … ; 0.0664132934836443 0.0641530052864508 … 0.05747311921193542 0.06415300528618365; 0.07647151840866216 0.07121914197161659 … 0.06415300528620428 0.07270707893323225;;; … ;;; 0.060012815483629564 0.06348370462377961 … 0.029186011402093297 0.04413141881843438; 0.06348370462479251 0.059794460955784424 … 0.04476312021835006 0.05713332556859959; … ; 0.029186011399003585 0.04476312021409566 … 0.015925084145427842 0.015925084145024578; 0.04413141881678473 0.05713332556597563 … 0.0159250841463116 0.02485744320749734;;; 0.07655587366943854 0.07647151840813679 … 0.03956580495733968 0.061384247178712444; 0.0764715184087846 0.07270707893318074 … 0.05738308452908341 0.07121914197251769; … ; 0.039565804955085895 0.05738308452611545 … 0.005337878764922078 0.015925084145164452; 0.06138424717757311 0.0712191419707824 … 0.015925084146099677 0.03680319832602966;;; 0.090854013379504 0.08747433053376306 … 0.06138424717877287 0.08147776991010941; 0.08747433053413492 0.0831614881531424 … 0.07121914197257287 0.08316148815357054; … ; 0.06138424717736163 0.07121914197079471 … 0.01592508414522248 0.03680319832549682; 0.08147776990942075 0.08316148815255302 … 0.03680319832608188 0.06246757364740304;;;;], eigenvalues = Any[[-0.16217594588397616, -0.07512573394995209, -0.07512573394627725, -0.07512573394444139, -0.07512573394296558, -0.01016811405970237, -0.010168114057351373, -0.010168114057009698, -0.010168114055686054, -0.010168114055072135  …  0.22436299900882592, 0.22436299900994539, 0.2243629990101381, 0.22436299901145168, 0.2243629990122028, 0.22436299901412243, 0.2243629990144587, 0.2705989718848552, 0.27059897188562565, 0.2705989718863102]], occupation = [[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0  …  2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]], εF = nothing, n_iter = 3, ψ = Matrix{ComplexF64}[[0.9333608589771373 + 0.21137304384869104im 7.594640350362235e-12 - 1.9188849050303866e-12im … 6.071593156526192e-13 - 1.0778475481443278e-12im 3.6499482155874407e-13 - 5.379962924766782e-13im; -2.697692397701963e-12 + 1.5302561735125453e-12im -0.19165882366214942 + 0.048955275099856164im … -2.6463456432982996e-12 + 2.2486122999812756e-11im -7.560251215891394e-12 - 8.402736884556051e-12im; … ; -7.175228835566705e-13 + 1.184527561825491e-12im -2.854112906503967e-12 + 2.917885497024514e-12im … -5.5408715843882714e-11 + 5.049097333824647e-11im -2.6915203098503045e-11 - 1.4483693771779639e-11im; -5.22083680559935e-13 - 4.784977152942884e-12im -0.08168334277683585 - 0.3196922533315775im … 2.1820836707061107e-12 - 6.8352486892080836e-12im -4.369777917178817e-13 - 2.5997175076700495e-12im]], stage = :finalize, algorithm = &quot;Newton&quot;)</pre><pre><code class="language-julia">scfres_newton.energies</code></pre><pre class="documenter-example-output">Energy breakdown (in Ha):
    Kinetic             25.7697876
    AtomicLocal         -18.8616201
    AtomicNonlocal      14.8540134
    Ewald               -67.1831486
    PspCorrection       -2.3569765
    Hartree             4.8508714 
    Xc                  -19.3506430

    total               -62.277715861369</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metallic_systems/">« Temperature and metallic systems</a><a class="docs-footer-nextpage" href="../ase/">Creating slabs with ASE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 20 March 2022 15:32">Sunday 20 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
