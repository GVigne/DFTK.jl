<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating supercells with pymatgen · DFTK.jl</title><link rel="canonical" href="https://docs.dftk.org/stable/examples/pymatgen/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DFTK.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../guide/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Introduction to periodic problems</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Density-functional theory</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li class="is-active"><a class="tocitem" href>Creating supercells with pymatgen</a></li><li><a class="tocitem" href="../ase/">Creating slabs with ASE</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Advanced topics</span><ul><li><a class="tocitem" href="../../advanced/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../advanced/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../advanced/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../advanced/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/pymatgen.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Creating-supercells-with-pymatgen"><a class="docs-heading-anchor" href="#Creating-supercells-with-pymatgen">Creating supercells with pymatgen</a><a id="Creating-supercells-with-pymatgen-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-supercells-with-pymatgen" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/pymatgen.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/pymatgen.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>The <a href="https://pymatgen.org/">Pymatgen</a> python library allows to setup solid-state calculations using a flexible set of classes as well as an API to an online data base of structures. Its <code>Structure</code> and <code>Lattice</code> objects are directly supported by the DFTK <code>load_atoms</code> and <code>load_lattice</code> functions, such that DFTK may be readily used to run calculation on systems defined in pymatgen. Using the <code>pymatgen_structure</code> function a conversion from DFTK to pymatgen structures is also possible. In the following we use this to create a silicon supercell and find its LDA ground state using direct minimisation. To run this example Julia&#39;s <code>PyCall</code> package needs to be able to find an installation of <code>pymatgen</code>.</p><p>First we setup the silicon lattice in DFTK.</p><pre><code class="language-julia">using DFTK

a = 10.263141334305942  # Lattice constant in Bohr
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8];</code></pre><p>Next we make a <code>[2, 2, 2]</code> supercell using pymatgen</p><pre><code class="language-julia">pystruct = pymatgen_structure(lattice, atoms, positions)
pystruct.make_supercell([2, 2, 2])
lattice   = load_lattice(pystruct)
positions = load_positions(pystruct)
atoms     = fill(Si, length(positions));</code></pre><p>Setup an LDA model and discretize using a single k-point and a small <code>Ecut</code> of 5 Hartree.</p><pre><code class="language-julia">model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=(1, 1, 1))</code></pre><pre class="documenter-example-output">PlaneWaveBasis discretization:
    Ecut                 : 5.0 Ha
    fft_size             : (32, 32, 32), 32768 total points
    kgrid type           : Monkhorst-Pack
    kgrid                : [1, 1, 1]
    num. irred. kpoints  : 1

    Discretized Model(lda_x+lda_c_pw, 3D):
        lattice (in Bohr)    : [0         , 10.2631   , 10.2631   ]
                               [10.2631   , 0         , 10.2631   ]
                               [10.2631   , 10.2631   , 0         ]
        unit cell volume     : 2162.1 Bohr³
    
        atoms                : Si₁₆
        atom potentials      : ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
    
        num. electrons       : 64
        spin polarization    : none
        temperature          : 0 Ha
    
        terms                : Kinetic()
                               AtomicLocal()
                               AtomicNonlocal()
                               Ewald()
                               PspCorrection()
                               Hartree()
                               Xc([:lda_x, :lda_c_pw])</pre><p>Find the ground state using direct minimisation and newton (always using SCF is boring ...)</p><pre><code class="language-julia">scfres = direct_minimization(basis; tol=1e-3);
ψ, _ = DFTK.select_occupied_orbitals(basis, scfres.ψ, scfres.occupation)
scfres_newton = newton(basis, ψ; tol=1e-12)</code></pre><pre class="documenter-example-output">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3000838204844399 -0.38651676076137903 … -0.6442304016759204 -0.38651676076137265; -0.38651676076137914 -0.768132121776889 … -0.2500340648365427 -0.24218268965121173; … ; -0.6442304016759205 -0.25003406483654256 … -3.0211542861086325 -1.4664153489044962; -0.3865167607613723 -0.24218268965121167 … -1.466415348904496 -0.7681321217768756;;; -0.3865167607613794 -0.7681321217768898 … -0.25003406483654234 -0.24218268965121173; -0.7681321217768898 -1.8161936706060218 … -0.13699557143111138 -0.312988420493962; … ; -0.25003406483654256 -0.1369955714311113 … -0.9870510298301364 -0.5277759153846058; -0.24218268965121126 -0.3129884204939619 … -0.5277759153846058 -0.3129884204939551;;; -0.6442304016759322 -1.4664153489045144 … -0.08831357031438808 -0.25003406483654783; -1.4664153489045144 -4.114878101698644 … -0.14040892324045914 -0.5277759153846148; … ; -0.08831357031438869 -0.14040892324045884 … -0.26983750242606713 -0.14040892324045487; -0.2500340648365478 -0.5277759153846147 … -0.14040892324045426 -0.1369955714311098;;; … ;;; -0.9859863776629684 -0.35824744851609447 … -4.090627806711926 -2.29024663594557; -0.3582474485160943 -0.08635610801077073 … -1.4293432742461814 -0.8160371791714962; … ; -4.090627806711926 -1.4293432742461816 … -8.358403967979397 -8.33163370910521; -2.29024663594557 -0.8160371791714959 … -8.33163370910521 -5.7704684544717795;;; -0.6442304016759217 -0.25003406483654367 … -3.021154286108632 -1.466415348904497; -0.25003406483654367 -0.13699557143111163 … -0.9870510298301353 -0.5277759153846068; … ; -3.021154286108632 -0.9870510298301354 … -12.395558685839045 -8.358412346516113; -1.4664153489044969 -0.5277759153846068 … -8.358412346516113 -4.114878101698615;;; -0.3865167607613733 -0.24218268965121195 … -1.4664153489044964 -0.7681321217768768; -0.24218268965121206 -0.31298842049396153 … -0.5277759153846063 -0.3129884204939567; … ; -1.4664153489044964 -0.5277759153846062 … -8.358412346516115 -4.114878101698615; -0.7681321217768764 -0.3129884204939567 … -4.114878101698615 -1.8161936706059967]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.4147537431827399 0.3966771734120796 … 0.35153735664877334 0.39667717341609265; 0.39667717341483166 0.3789391676795037 … 0.32946849925633315 0.37730849083107937; … ; 0.3515373566431955 0.3294684992488434 … 0.30553228032691354 0.3369272441582581; 0.39667717341329256 0.37730849082585927 … 0.33692724416121933 0.37893916768184643;;; 0.3966771734162473 0.378939167680475 … 0.3294684992582312 0.3773084908328262; 0.3789391676828386 0.3562927712533171 … 0.3081672340010066 0.3613386510438254; … ; 0.3294684992536951 0.3081672339947891 … 0.2925295693708801 0.32135530621866; 0.37730849083051693 0.3613386510393923 … 0.321355306221082 0.3613386510437109;;; 0.3515373566487855 0.3369272441597631 … 0.27624730572099787 0.32946849925814814; 0.33692724416152425 0.31709362590803053 … 0.2653418753340519 0.3213553062205611; … ; 0.2762473057176559 0.2653418753293626 … 0.2378257613511523 0.26534187533327586; 0.3294684992564127 0.3213553062171935 … 0.2653418753350353 0.308167234001485;;; … ;;; 0.3043050825449349 0.2747728361183671 … 0.2897747264720596 0.3020547627182471; 0.27477283612009284 0.2424981276509711 … 0.26708985528429635 0.27937033528394634; … ; 0.28977472647008334 0.26708985528090834 … 0.2926353972836882 0.29263539728497456; 0.302054762716986 0.2793703352810457 … 0.2926353972858998 0.29811662665638766;;; 0.35153735664044 0.32946849924679344 … 0.30553228032322055 0.3369272441548869; 0.32946849924933613 0.30816723399157475 … 0.2925295693651563 0.3213553062133871; … ; 0.3055322803185488 0.29252956935840846 … 0.2835430036790585 0.29263539728856; 0.3369272441523359 0.3213553062085097 … 0.2926353972908107 0.3170936259019564;;; 0.39667717341187825 0.3773084908248253 … 0.33692724415935865 0.3789391676801307; 0.37730849082766066 0.36133865103735857 … 0.32135530621730884 0.36133865104022933; … ; 0.33692724415349895 0.3213553062093539 … 0.2926353972924655 0.3170936259034361; 0.3789391676771334 0.36133865103472435 … 0.3170936259064321 0.3562927712514101]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.5113149641955369 -0.5025077544836375 … -0.47663248326142527 -0.502507754484724; -0.50250775448458 -0.48588487146248954 … -0.4764704240190789 -0.4966568013420988; … ; -0.4766324832590911 -0.476470424016484 … -0.3891035353091684 -0.44527691908668293; -0.5025077544837759 -0.49665680134047857 … -0.4452769190882401 -0.4858848714630719;;; -0.5025077544847687 -0.48588487146250925 … -0.4764704240194142 -0.49665680134239065; -0.48588487146341935 -0.44768088614849455 … -0.4691108988288384 -0.4889624560204997; … ; -0.47647042401812134 -0.46911089882718815 … -0.4361387873545905 -0.4661303640531169; -0.4966568013417899 -0.4889624560192105 … -0.4661303640539239 -0.4889624560204058;;; -0.47663248326117325 -0.44527691908687855 … -0.4562036919150101 -0.4764704240194159; -0.4452769190875676 -0.3805736265944707 … -0.45136507975899265 -0.4661303640534638; … ; -0.45620369191437043 -0.4513650797580521 … -0.43634911905545387 -0.4513650797591494; -0.4764704240190508 -0.4661303640525678 … -0.45136507975951967 -0.4691108988290757;;; … ;;; -0.442191773560268 -0.44991004399468904 … -0.3545229620004759 -0.40234903539831657; -0.4499100439955938 -0.4416961440268245 … -0.40410681005994464 -0.4355541400390967; … ; -0.3545229619991902 -0.4041068100573913 … -0.294800618792444 -0.29480061879358277; -0.4023490353972868 -0.4355541400371641 … -0.2948006187935184 -0.3375734615384492;;; -0.4766324832592069 -0.47647042401672063 … -0.3891035353085816 -0.445276919086525; -0.476470424017768 -0.46911089882715756 … -0.43613878735360856 -0.46613036405243596; … ; -0.38910353530430947 -0.43613878734909794 … -0.21186524619068037 -0.29480061879335745; -0.44527691908474026 -0.46613036404989944 … -0.29480061879642927 -0.38057362659341354;;; -0.5025077544837403 -0.49665680134053497 … -0.4452769190880202 -0.485884871462942; -0.4966568013415093 -0.48896245601920196 … -0.4661303640533394 -0.48896245601992766; … ; -0.4452769190843324 -0.4661303640495111 … -0.29480061879655617 -0.38057362659314514; -0.48588487146149606 -0.48896245601781596 … -0.38057362659576327 -0.4476808861483774])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3966450414972369 -0.49234734183293694 … -0.7693255282885723 -0.49234734183000395; -0.49234734183112744 -0.8750778255598749 … -0.3970359895992885 -0.36153100016223116; … ; -0.7693255282918161 -0.3970359896041831 … -3.1047255410908874 -1.5747650238329212; -0.4923473418318557 -0.36153100016583095 … -1.5747650238315165 -0.8750778255581011;;; -0.4923473418299008 -0.8750778255589241 … -0.39703598959772535 -0.3615310001607762; -0.8750778255574706 -1.9075817855011992 … -0.29793923625894314 -0.44061222547063633; … ; -0.3970359896009688 -0.2979392362635103 … -1.1306602478138468 -0.6725509732190627; -0.36153100016248424 -0.44061222547378015 … -0.6725509732174477 -0.44061222547065;;; -0.7693255282883199 -1.57476502383163 … -0.2682699565084003 -0.3970359895978156; -1.5747650238305577 -4.178358102385085 … -0.32643212766539986 -0.6725509732175174; … ; -0.26826995651110325 -0.32643212766914836 … -0.4683608601303687 -0.32643212766632845; -0.3970359895991859 -0.672550973219989 … -0.3264321276649387 -0.2979392362587005;;; … ;;; -1.1238730686783016 -0.5333846563924164 … -4.155376042240342 -2.3905409086256397; -0.5333846563915953 -0.28555412438662414 … -1.5663602290218295 -0.9722209839266467; … ; -4.155376042241033 -1.5663602290226646 … -8.360569189488153 -8.333798930613817; -2.390540908625871 -0.9722209839276142 … -8.33379893061283 -5.809925289353841;;; -0.7693255282946886 -0.39703598960647085 … -3.104725541093993 -1.574765023836135; -0.39703598960497555 -0.29793923626669444 … -1.1306602478185876 -0.6725509732236556; … ; -3.1047255410943926 -1.130660247820825 … -12.323880928350667 -8.360577568020911; -1.5747650238369013 -0.6725509732259964 … -8.360577568021732 -4.178358102390072;;; -0.49234734183323536 -0.36153100016692163 … -1.5747650238331579 -0.8750778255596882; -0.3615310001650607 -0.4406122254758049 … -0.672550973220637 -0.44061222547365503; … ; -1.57476502383533 -0.6725509732247634 … -8.360577568020204 -4.178358102388324; -0.875077825561239 -0.4406122254770483 … -4.1783581023879455 -1.907581785502964]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[1.5900025884980906e-7 - 8.798430504632776e-7im -7.315393986389793e-6 + 1.415954502872559e-5im … 0.019056360871076095 + 0.04663723026921901im -7.340443821496038e-6 + 1.5383203075533167e-5im; -7.419692307169232e-7 + 1.5368969207289548e-6im 2.9175207630840164e-7 - 9.9093527108904e-6im … -1.6910498140551823e-6 + 2.96116628966543e-6im -4.427339008190034e-6 - 4.498705872861664e-6im; … ; -0.0007503793196329319 - 0.06582041435276807im -1.1009046455256448e-5 + 2.6373509870034078e-5im … 0.02138135323344561 - 0.022405015800947968im -1.8083539516903202e-5 + 4.705555551178093e-5im; -1.5271826929311866e-6 + 1.5034958453381395e-6im 1.154367785049722e-5 - 1.1981683918084957e-5im … -3.561431960490059e-6 + 5.237134042915869e-6im 6.2363040575278935e-6 - 5.208637601594474e-6im;;; -7.585073987075377e-6 - 1.665205307215021e-6im 1.2600717692996778e-5 - 1.0350825847920866e-5im … -7.30134991583187e-6 - 3.5686029054772415e-6im 1.8903695507836103e-5 - 9.300016489862135e-6im; 9.419146171311065e-6 - 1.3830428481089485e-5im 1.956619021394718e-6 + 5.160972499201813e-6im … 6.465673487552188e-6 - 1.0755309987774081e-5im -2.0077227876191076e-5 + 5.355085060197905e-6im; … ; -6.9610360593233095e-6 + 1.961406902115116e-5im 7.506928074491161e-6 - 9.251571293878166e-6im … -1.0127154968140313e-5 + 2.61362591578215e-5im 1.3515618299721733e-5 - 1.6022078651910495e-5im; 6.096796123390987e-6 - 1.554220495447915e-5im 1.2652803253665656e-5 + 8.742535632995859e-6im … 1.0822374589701843e-5 - 1.6713857216864028e-5im -9.13731264778377e-6 + 7.972410953087299e-6im;;; 0.06446553527632196 - 0.1372439044608899im -2.4487151595708152e-5 + 4.7504591507473886e-5im … 0.02414975650309094 - 0.026198302867892466im -1.3876083028593736e-5 + 2.7674773266206837e-5im; -5.759831524663239e-6 + 6.661644446965236e-6im -1.9154670935259722e-5 + 2.8767680491493488e-5im … -2.3059404235161887e-6 + 2.613291743525286e-6im -1.4674550871497415e-5 + 1.802852639937463e-5im; … ; 0.018422781603573704 - 0.058714613066545046im -1.0057082621920746e-5 + 1.8954367872904605e-5im … -0.0028825280267353384 + 0.01571975540456884im -7.174324622465664e-6 + 1.866965842865825e-5im; -3.3745944100639058e-6 + 3.5638504658681407e-6im -4.7963224553792615e-6 + 1.3400232262042382e-5im … -1.2637950611360384e-6 + 1.9746393238090098e-6im 1.94289717126134e-6 - 1.4797553315352982e-6im;;; … ;;; 5.658426710621597e-6 + 3.7955266826099378e-6im -6.839475397026141e-6 - 1.0356983376346652e-5im … -4.161254209354076e-6 - 3.893757954388448e-6im 9.60807378325179e-8 - 6.365075800263558e-6im; 1.4754780116788409e-6 - 7.207439313995135e-6im 2.1006144319986834e-6 + 1.6428532495315218e-7im … 6.158245690228861e-6 - 8.402376667283866e-6im -7.967693439028075e-6 + 8.483583418099092e-7im; … ; -3.652231139525024e-6 + 3.078158324119693e-5im 2.626363805019004e-6 - 1.0403437192916344e-5im … -9.315366494781739e-6 + 1.4823318363837465e-5im 8.190285591679686e-6 - 6.289328231684542e-6im; -2.155561534555722e-7 - 6.175014919768064e-6im 4.800890938552674e-6 + 2.169866302145876e-6im … 6.5517732885154435e-6 - 5.747145848894617e-6im -5.485536303403166e-6 + 2.603932914633016e-6im;;; 0.06446553527245816 - 0.13724390446161094im -1.3866851989019732e-5 + 2.72237511898737e-5im … 0.09755414458424021 - 0.10582831276201363im -2.4517144498328158e-5 + 4.896965250206911e-5im; -3.0851819600189705e-6 + 3.5761698619573027e-6im -2.91221832340455e-7 - 3.246349380054763e-6im … -5.866616345897256e-6 + 7.286369687182432e-6im -1.24769170835785e-5 + 1.9766371549934276e-5im; … ; 0.074419688871268 - 0.23717988167219148im -2.5330293231451934e-5 + 5.706840470768497e-5im … 0.08277117006374202 - 0.1564251697041079im -3.483081084326386e-5 + 7.966065281810137e-5im; -6.6999549391941e-6 + 6.621660399537181e-6im -2.59868989826803e-6 + 1.5138077434035771e-5im … -8.590642266597224e-6 + 1.0270017343333063e-5im -1.2674428763973874e-5 + 3.389202599033212e-5im;;; 4.33684540746432e-6 + 4.437193647194886e-6im -3.200803095734264e-6 - 1.939916453599764e-5im … -2.863301180560246e-6 - 3.1209896895336223e-6im 1.8040657641888792e-6 - 1.5975899289021043e-5im; 6.49613194342654e-6 - 1.6795647103437598e-5im 2.975498305357073e-6 + 3.4567422087201513e-6im … 1.1069367516014283e-5 - 1.7489122015353148e-5im -1.881461564718629e-5 + 2.6866158747835855e-6im; … ; -2.0971731195192054e-6 + 4.90687545646565e-5im -1.5622745548241454e-7 - 2.2268499046263214e-5im … -1.0378697295168168e-5 + 4.0827863104577386e-5im 3.836527092285577e-6 - 2.4470900121543858e-5im; 2.1327978076480504e-6 - 1.583418795589313e-5im 1.391541275695625e-5 + 6.0740675881074975e-6im … 1.2450949048940443e-5 - 1.9277377296266812e-5im -7.10310776594087e-6 + 4.3849214170850305e-6im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -62.27771586136885), converged = true, ρ = [0.096107201317712 0.09085401337996682 … 0.07655587367081312 0.09085401338060248; 0.09085401338051832 0.08147776991063176 … 0.07647151840937741 0.0874743305347499; … ; 0.07655587366959765 0.0764715184080272 … 0.039565804956848326 0.061384247178773006; 0.09085401338004781 0.08747433053382608 … 0.06138424717947052 0.08147776991094813;;; 0.09085401338062875 0.0814777699106425 … 0.07647151840955185 0.08747433053491638; 0.08147776991113691 0.06246757364846212 … 0.07270707893397516 0.08316148815410056; … ; 0.07647151840887914 0.07270707893314553 … 0.057383084528318945 0.0712191419724309; 0.08747433053457386 0.08316148815339036 … 0.07121914197283093 0.0831614881540488;;; 0.07655587367068187 0.06138424717886063 … 0.06641329348449364 0.07647151840955273; 0.0613842471791693 0.0368031983265984 … 0.06415300528709876 0.07121914197260287; … ; 0.06641329348419125 0.06415300528666458 … 0.057473119213335165 0.06415300528717112; 0.07647151840936277 0.07121914197215871 … 0.06415300528734207 0.07270707893409446;;; … ;;; 0.06001281548329019 0.06348370462369966 … 0.029186011399989473 0.04413141881729182; 0.06348370462411437 0.059794460955502414 … 0.044763120215441335 0.057133325566980614; … ; 0.029186011399642914 0.04476312021451927 … 0.015925084145267415 0.01592508414547001; 0.04413141881692355 0.057133325566156246 … 0.01592508414545856 0.024857443207213833;;; 0.07655587366965795 0.07647151840815034 … 0.03956580495665354 0.06138424717870223; 0.07647151840869529 0.07270707893313014 … 0.057383084527898864 0.07121914197209336; … ; 0.03956580495523553 0.05738308452596907 … 0.005337878765067291 0.015925084145429914; 0.06138424717790277 0.07121914197083597 … 0.01592508414597642 0.036803198326264455;;; 0.09085401338002698 0.08747433053385825 … 0.06138424717937204 0.08147776991087756; 0.0874743305344138 0.0831614881533856 … 0.07121914197254119 0.0831614881537854; … ; 0.06138424717772004 0.07121914197064345 … 0.015925084145998997 0.036803198326179676; 0.081477769910092 0.08316148815262205 … 0.036803198327006716 0.062467573648409026;;;;], eigenvalues = Any[[-0.16217594588316275, -0.0751257339469973, -0.07512573394493892, -0.07512573394470456, -0.07512573394306987, -0.010168114057257774, -0.01016811405629332, -0.010168114055908766, -0.010168114055285941, -0.010168114054571329  …  0.2243629990104487, 0.22436299901172177, 0.22436299901190782, 0.2243629990121297, 0.22436299901273246, 0.2243629990135068, 0.22436299901447704, 0.2705989718864346, 0.2705989718868917, 0.27059897188701443]], occupation = [[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0  …  2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]], εF = nothing, n_iter = 4, ψ = Matrix{ComplexF64}[[0.17018896461123317 - 0.9417413514639337im -2.5044799395027337e-12 + 4.337371991062804e-12im … 1.4028475374118625e-12 - 1.0033029290106846e-12im 7.114482261832834e-13 + 2.4821184534188674e-13im; -7.210989546403506e-12 + 8.812815251770814e-12im 0.07417243958907326 - 0.12809814349306273im … 3.70549992074451e-12 + 6.582231834982729e-12im -4.606144962468478e-12 + 9.807778250165615e-13im; … ; -1.1969425627744652e-12 - 1.7301090652499492e-13im -2.0924751029257495e-12 - 2.949095278587994e-12im … 1.3486888205528982e-11 - 2.916345394614762e-11im -1.5068079440704474e-11 + 9.890251209732136e-13im; -1.705725723494711e-11 + 2.5310760694575974e-12im -0.30810286708789525 - 0.17837437432776526im … 8.692908927952249e-13 + 3.115876951392078e-13im 1.254408820977463e-12 + 3.1972680931838596e-13im]], stage = :finalize, algorithm = &quot;Newton&quot;)</pre><pre><code class="language-julia">scfres_newton.energies</code></pre><pre class="documenter-example-output">Energy breakdown (in Ha):
    Kinetic             25.7697876
    AtomicLocal         -18.8616201
    AtomicNonlocal      14.8540134
    Ewald               -67.1831486
    PspCorrection       -2.3569765
    Hartree             4.8508714 
    Xc                  -19.3506430

    total               -62.277715861369</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metallic_systems/">« Temperature and metallic systems</a><a class="docs-footer-nextpage" href="../ase/">Creating slabs with ASE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 20 March 2022 18:24">Sunday 20 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
