<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating supercells with pymatgen · DFTK.jl</title><link rel="canonical" href="https://docs.dftk.org/stable/examples/pymatgen/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DFTK.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../guide/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Introduction to periodic problems</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Density-functional theory</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li class="is-active"><a class="tocitem" href>Creating supercells with pymatgen</a></li><li><a class="tocitem" href="../ase/">Creating slabs with ASE</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Advanced topics</span><ul><li><a class="tocitem" href="../../advanced/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../advanced/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../advanced/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../advanced/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/pymatgen.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Creating-supercells-with-pymatgen"><a class="docs-heading-anchor" href="#Creating-supercells-with-pymatgen">Creating supercells with pymatgen</a><a id="Creating-supercells-with-pymatgen-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-supercells-with-pymatgen" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/pymatgen.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/pymatgen.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>The <a href="https://pymatgen.org/">Pymatgen</a> python library allows to setup solid-state calculations using a flexible set of classes as well as an API to an online data base of structures. Its <code>Structure</code> and <code>Lattice</code> objects are directly supported by the DFTK <code>load_atoms</code> and <code>load_lattice</code> functions, such that DFTK may be readily used to run calculation on systems defined in pymatgen. Using the <code>pymatgen_structure</code> function a conversion from DFTK to pymatgen structures is also possible. In the following we use this to create a silicon supercell and find its LDA ground state using direct minimisation. To run this example Julia&#39;s <code>PyCall</code> package needs to be able to find an installation of <code>pymatgen</code>.</p><p>First we setup the silicon lattice in DFTK.</p><pre><code class="language-julia">using DFTK

a = 10.263141334305942  # Lattice constant in Bohr
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8];</code></pre><p>Next we make a <code>[2, 2, 2]</code> supercell using pymatgen</p><pre><code class="language-julia">pystruct = pymatgen_structure(lattice, atoms, positions)
pystruct.make_supercell([2, 2, 2])
lattice   = load_lattice(pystruct)
positions = load_positions(pystruct)
atoms     = fill(Si, length(positions));</code></pre><p>Setup an LDA model and discretize using a single k-point and a small <code>Ecut</code> of 5 Hartree.</p><pre><code class="language-julia">model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=(1, 1, 1))</code></pre><pre class="documenter-example-output">PlaneWaveBasis discretization:
    Ecut                 : 5.0 Ha
    fft_size             : (32, 32, 32), 32768 total points
    kgrid type           : Monkhorst-Pack
    kgrid                : [1, 1, 1]
    num. irred. kpoints  : 1

    Discretized Model(lda_x+lda_c_pw, 3D):
        lattice (in Bohr)    : [0         , 10.2631   , 10.2631   ]
                               [10.2631   , 0         , 10.2631   ]
                               [10.2631   , 10.2631   , 0         ]
        unit cell volume     : 2162.1 Bohr³
    
        atoms                : Si₁₆
        atom potentials      : ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
    
        num. electrons       : 64
        spin polarization    : none
        temperature          : 0 Ha
    
        terms                : Kinetic()
                               AtomicLocal()
                               AtomicNonlocal()
                               Ewald()
                               PspCorrection()
                               Hartree()
                               Xc([:lda_x, :lda_c_pw])</pre><p>Find the ground state using direct minimisation and newton (always using SCF is boring ...)</p><pre><code class="language-julia">scfres = direct_minimization(basis; tol=1e-3);
ψ, _ = DFTK.select_occupied_orbitals(basis, scfres.ψ, scfres.occupation)
scfres_newton = newton(basis, ψ; tol=1e-12)</code></pre><pre class="documenter-example-output">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3000838204844425 -0.3865167607613796 … -0.6442304016759225 -0.3865167607613762; -0.38651676076137836 -0.768132121776888 … -0.25003406483654445 -0.24218268965121242; … ; -0.6442304016759215 -0.25003406483654483 … -3.0211542861086316 -1.466415348904496; -0.3865167607613758 -0.24218268965121426 … -1.4664153489044964 -0.7681321217768781;;; -0.38651676076138003 -0.7681321217768898 … -0.25003406483654433 -0.24218268965121348; -0.7681321217768886 -1.8161936706060204 … -0.13699557143111202 -0.31298842049396153; … ; -0.25003406483654467 -0.13699557143111366 … -0.9870510298301364 -0.527775915384607; -0.24218268965121384 -0.3129884204939632 … -0.527775915384607 -0.31298842049395803;;; -0.6442304016759322 -1.4664153489045144 … -0.088313570314389 -0.25003406483654844; -1.466415348904513 -4.114878101698642 … -0.1404089232404591 -0.5277759153846142; … ; -0.08831357031439022 -0.14040892324046036 … -0.26983750242606713 -0.1404089232404561; -0.2500340648365487 -0.527775915384615 … -0.14040892324045487 -0.13699557143111132;;; … ;;; -0.9859863776629685 -0.3582474485160946 … -4.090627806711927 -2.290246635945571; -0.3582474485160946 -0.08635610801077073 … -1.4293432742461816 -0.8160371791714963; … ; -4.090627806711926 -1.4293432742461822 … -8.358403967979397 -8.331633709105212; -2.29024663594557 -0.8160371791714961 … -8.33163370910521 -5.7704684544717795;;; -0.6442304016759224 -0.2500340648365443 … -3.021154286108632 -1.4664153489044973; -0.2500340648365441 -0.13699557143111132 … -0.9870510298301357 -0.5277759153846076; … ; -3.021154286108632 -0.9870510298301353 … -12.395558685839045 -8.358412346516113; -1.4664153489044964 -0.5277759153846068 … -8.358412346516113 -4.114878101698613;;; -0.38651676076137653 -0.24218268965121348 … -1.4664153489044973 -0.7681321217768792; -0.24218268965121248 -0.3129884204939609 … -0.5277759153846076 -0.3129884204939583; … ; -1.4664153489044955 -0.5277759153846068 … -8.358412346516111 -4.114878101698615; -0.768132121776878 -0.3129884204939586 … -4.114878101698614 -1.816193670605997]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035007im 0.05414494805835375 - 0.0224275718197569im … 0.003755074015300082 - 0.00906555061545225im -0.003755074015300082 + 0.00906555061545225im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 7.962118806259657e-18im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.00906555061545225 + 0.003755074015300082im 0.00906555061545225 + 0.003755074015300082im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.4147537431638001 0.3966771733951292 … 0.35153735663024743 0.39667717339687186; 0.3966771734003254 0.3789391676673545 … 0.3294684992413654 0.37730849081588086; … ; 0.35153735662269164 0.3294684992289471 … 0.3055322803088814 0.33692724413859054; 0.396677173392279 0.3773084908062575 … 0.3369272441416435 0.3789391676610557;;; 0.3966771733979024 0.3789391676654133 … 0.3294684992387727 0.3773084908132493; 0.37893916766976715 0.35629277124372927 … 0.3081672339859046 0.36133865102905277; … ; 0.32946849923113536 0.30816723397419815 … 0.292529569349126 0.32135530619585806; 0.3773084908089398 0.3613386510205064 … 0.3213553061992682 0.361338651021356;;; 0.3515373566327346 0.33692724414814573 … 0.2762473057020652 0.3294684992397778; 0.3369272441509138 0.3170936259015836 … 0.2653418753196594 0.32135530620724084; … ; 0.2762473056955036 0.26534187531038556 … 0.23782576132795902 0.26534187530984066; 0.32946849923638066 0.321355306201099 … 0.26534187531303544 0.30816723397966916;;; … ;;; 0.3043050825340065 0.27477283610575803 … 0.2897747264656519 0.3020547627097679; 0.2747728361096694 0.24249812763952594 … 0.26708985527738655 0.27937033527539196; … ; 0.28977472646395896 0.267089855272016 … 0.29263539728349774 0.29263539728186094; 0.30205476270771575 0.2793703352694183 … 0.2926353972819086 0.2981166266499212;;; 0.3515373566255224 0.32946849923143395 … 0.30553228031153706 0.33692724414153236; 0.32946849923626703 0.3081672339785567 … 0.2925295693542472 0.3213553062013051; … ; 0.305532280307429 0.29252956934538366 … 0.28354300367245777 0.29263539727974264; 0.33692724413819075 0.32135530619315583 … 0.2926353972807449 0.31709362588989326;;; 0.39667717339414954 0.3773084908078581 … 0.33692724414350045 0.3789391676630351; 0.37730849081316387 0.3613386510240026 … 0.32135530620368563 0.3613386510259035; … ; 0.33692724413719805 0.32135530619226776 … 0.2926353972797847 0.3170936258888503; 0.3789391676587786 0.36133865101646007 … 0.3170936258910139 0.3562927712342904]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.5113149641915548 -0.5025077544795293 … -0.47663248325804936 -0.502507754481082; -0.5025077544814802 -0.4858848714592916 … -0.47647042401714357 -0.4966568013395904; … ; -0.4766324832554158 -0.476470424012891 … -0.3891035353051154 -0.445276919082893; -0.5025077544795481 -0.4966568013363021 … -0.44527691908396105 -0.48588487145883225;;; -0.5025077544805143 -0.48588487145840636 … -0.4764704240161029 -0.49665680133860923; -0.48588487146027254 -0.4476808861457124 … -0.4691108988268511 -0.4889624560177859; … ; -0.47647042401369355 -0.46911089882293233 … -0.43613878734992795 -0.46613036404855596; -0.49665680133722473 -0.48896245601473304 … -0.4661303640495866 -0.48896245601599486;;; -0.47663248325697205 -0.44527691908353684 … -0.45620369191179977 -0.47647042401551426; -0.4452769190847919 -0.3805736265925151 … -0.451365079756903 -0.4661303640507153; … ; -0.4562036919096702 -0.4513650797537082 … -0.4363491190507205 -0.45136507975441814; -0.47647042401437717 -0.46613036404842606 … -0.4513650797553991 -0.4691108988246579;;; … ;;; -0.4421917735575999 -0.4499100439916275 … -0.3545229619992223 -0.40234903539651296; -0.44991004399332846 -0.4416961440240894 … -0.40410681005959903 -0.43555414003780957; … ; -0.354522961999757 -0.4041068100573911 … -0.29480061879570046 -0.2948006187949079; -0.4023490353953716 -0.4355541400348626 … -0.29480061879255326 -0.3375734615369665;;; -0.4766324832559018 -0.4764704240133058 … -0.3891035353060448 -0.4452769190836393; -0.47647042401516165 -0.4691108988241781 … -0.4361387873522684 -0.4661303640504365; … ; -0.3891035353040594 -0.4361387873481513 … -0.21186524619145394 -0.2948006187937712; -0.4452769190818966 -0.46613036404693864 … -0.294800618793121 -0.3805736265907548;;; -0.5025077544800652 -0.49665680133674317 … -0.44527691908487416 -0.48588487145952003; -0.496656801338645 -0.488962456015981 … -0.46613036405153835 -0.4889624560176254; … ; -0.44527691908212946 -0.4661303640470711 … -0.2948006187939085 -0.38057362659110366; -0.48588487145781184 -0.48896245601418514 … -0.3805736265919414 -0.44768088614472484])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.39664504151219715 -0.4923473418457797 … -0.7693255283037244 -0.4923473418455863; -0.4923473418425332 -0.8750778255688252 … -0.3970359896123226 -0.36153100017492196; … ; -0.7693255283086456 -0.39703598962048875 … -3.1047255411048655 -1.5747650238487987; -0.4923473418486449 -0.36153100018125883 … -1.574765023846814 -0.8750778255746546;;; -0.4923473418439919 -0.8750778255698829 … -0.39703598961387454 -0.3615310001765734; -0.875077825567394 -1.9075817855080035 … -0.2979392362720585 -0.44061222548269463; … ; -0.39703598961910286 -0.29793923627984786 … -1.1306602478309382 -0.672550973237305; -0.3615310001794988 -0.44061222548818985 … -0.6725509732349253 -0.4406122254885969;;; -0.7693255283001696 -1.5747650238399056 … -0.26826995652412355 -0.3970359896122849; -1.5747650238383912 -4.1783581023895735 … -0.3264321276777027 -0.6725509732280887; … ; -0.2682699565285568 -0.32643212768378305 … -0.4683608601488286 -0.3264321276850336; -0.3970359896145452 -0.6725509732319421 … -0.3264321276828185 -0.2979392362761001;;; … ;;; -1.123873068686562 -0.533384656401964 … -4.155376042245497 -2.390540908632316; -0.5333846563997536 -0.28555412439533423 … -1.566360229028394 -0.972220983933914; … ; -4.155376042247725 -1.5663602290315572 … -8.360569189491601 -8.333798930618258; -2.390540908633226 -0.9722209839369405 … -8.333798930615854 -5.809925289358825;;; -0.7693255283063019 -0.39703598961841613 … -3.10472554110314 -1.5747650238466044; -0.39703598961543873 -0.2979392362767327 … -1.1306602478281569 -0.6725509732337389; … ; -3.104725541105262 -1.1306602478329029 … -12.323880928358042 -8.360577568030141; -1.5747650238482023 -0.6725509732383896 … -8.36057756802849 -4.178358102399475;;; -0.49234734184729223 -0.36153100018009854 … -1.574765023845871 -0.8750778255733641; -0.3615310001766936 -0.4406122254859393 … -0.6725509732324603 -0.4406122254856802; … ; -1.574765023849427 -0.6725509732394102 … -8.360577568030235 -4.1783581024008685; -0.8750778255759112 -0.44061222549168366 … -4.1783581023995415 -1.9075817855164314]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035007im 0.05414494805835375 - 0.0224275718197569im … 0.003755074015300082 - 0.00906555061545225im -0.003755074015300082 + 0.00906555061545225im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 7.962118806259657e-18im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.00906555061545225 + 0.003755074015300082im 0.00906555061545225 + 0.003755074015300082im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-2.1069566697243247e-8 + 1.7441249238765028e-6im 1.6059485866181428e-6 - 6.037517725054037e-6im … 0.14747177165688224 - 0.026001720307229963im 3.847010615555366e-6 + 3.3788021935541014e-6im; 7.552400692322294e-6 + 3.417500523873799e-6im -1.2460775778012382e-5 + 6.439688430254841e-6im … 4.4673140023273355e-5 + 2.7552729452722526e-6im -1.3706455099056285e-5 - 5.5756807177165866e-6im; … ; 0.052263225949906233 + 0.06086877409054823im -8.298340879252767e-6 - 1.15933065849051e-5im … 0.23329235114031338 + 0.04072281986873619im -1.8912662109257467e-5 - 1.533553121862361e-5im; 7.248434382618766e-6 + 4.506767709189591e-6im -1.819889341642453e-5 + 1.000129548377077e-5im … 9.346947104717487e-5 + 3.6701766240982308e-6im -1.6807084694409194e-5 - 2.3799346303052973e-6im;;; 8.662347079953781e-6 - 1.9034345581766433e-6im -1.4103517880505095e-6 + 8.12004922617968e-6im … -1.67705987936189e-6 + 2.4053360885568663e-6im -3.3324152406232653e-6 + 2.077906043698014e-5im; -2.5128054564177484e-5 - 2.8682927521489424e-6im -2.5032173258131576e-6 - 3.2965088995149426e-6im … -9.398162654673022e-6 - 2.7876813878330645e-6im 4.004714756521376e-6 + 3.975671107320014e-5im; … ; 2.168090971854001e-5 - 5.340467791624542e-6im 6.832903119617881e-7 + 3.1373522790987903e-6im … 1.533008810563293e-5 - 4.845344231236321e-7im -3.743677906243409e-6 + 4.493488456390002e-6im; 1.49930587270405e-5 - 3.7813496126444715e-5im -3.0184205694569607e-5 - 6.113412185994823e-7im … 6.17073124300036e-5 - 3.466101493814189e-5im -2.3239955165896524e-5 + 4.240901195207013e-5im;;; -0.10613115794694095 - 0.09388078208906382im 2.0406078419970225e-5 + 1.1042182142270501e-5im … 0.011953336840032816 - 0.03466307082296102im 1.1184909573396858e-5 + 8.602234462463018e-6im; -5.359905437843178e-5 - 5.4008023497500856e-5im -4.016917165391015e-6 + 2.35285180061464e-5im … -2.4908851035755155e-5 - 2.0395380326252483e-5im -7.167055121407216e-6 + 9.142767428693935e-6im; … ; -0.015575521827188282 - 0.009545099052132106im 9.756961013889104e-6 + 5.255407195961657e-6im … 0.11605980295258765 + 0.03399083323353685im -8.084465249583955e-6 - 7.248540852885847e-6im; -2.0928353813061525e-5 - 2.188458230795932e-5im -9.945672411905578e-6 + 1.877727767383546e-5im … 4.127964624291859e-5 + 5.481152178484614e-6im -1.0857416870491575e-5 + 1.1896357022056822e-6im;;; … ;;; 7.68234643852535e-6 - 7.205866578352472e-6im 1.1777032306704964e-5 - 1.3408980475723553e-5im … -1.0450042050515361e-5 + 5.429365316552907e-6im 5.943228738211393e-6 - 7.992536331941967e-7im; -3.6243750093568996e-5 + 2.8549489342174404e-5im 1.6413880495591192e-5 - 3.095375444815132e-5im … 3.324994852670852e-5 - 8.050694315218925e-6im 1.1144634297203244e-5 + 3.9930880762966736e-7im; … ; 2.4487510522557413e-5 - 6.156366473486775e-6im 3.702870627490733e-7 - 5.608263444281245e-6im … 1.5675361582080179e-6 + 6.104133887921386e-6im -7.921728061372903e-6 + 2.2938524957520487e-6im; -2.3043557011011608e-6 - 1.5125142883513921e-6im -2.193093797299861e-6 - 1.5349008816698902e-5im … 7.738139021940216e-5 - 3.442804436381486e-5im -9.813377206324709e-6 + 2.0577609933613456e-5im;;; -0.1061311579406583 - 0.09388078205565421im 1.0358903899975024e-5 + 5.1315800988971525e-6im … 0.04828624597045554 - 0.14002609282322506im 2.30892684522471e-5 + 2.231619387237467e-5im; -2.0816327100672237e-5 - 2.2286054610201252e-5im -9.224006015089473e-6 + 4.504234058510671e-6im … 2.3451831695933633e-5 - 3.486198944549462e-5im -8.773872673675946e-6 + 5.882216856403964e-6im; … ; -0.06291821590860115 - 0.038560551999174145im 2.669068350548702e-7 - 7.388168734688778e-7im … 0.09360388559889336 - 0.05901753201158775im -5.032616443669526e-8 + 2.750471157688441e-6im; -5.39629944547127e-5 - 5.270385574335309e-5im -1.1552487779629243e-5 + 1.5516727396747336e-5im … 3.1856845912699874e-5 - 5.387874738583141e-5im -8.754913167194436e-6 + 1.3914099248684918e-5im;;; 1.4353509483094515e-5 - 1.0685432492582505e-5im 1.5652246763102063e-5 - 1.4292904067053062e-5im … -8.569776001337448e-6 + 2.2915257792462825e-6im 1.271172916176569e-5 - 2.17006814454352e-6im; -6.121158811082713e-5 + 3.712649596565202e-5im 1.8236630909509023e-5 - 3.8534480504504343e-5im … 1.4574000699069339e-5 + 1.1690091476123681e-5im 2.51808856970935e-5 + 4.485870976694008e-6im; … ; 4.4014617426279905e-5 - 1.5146124231521094e-5im 7.998517014641989e-6 - 1.719885996974196e-5im … 1.9859438522617833e-5 - 9.361419483954388e-7im 3.5389502181795616e-6 - 1.4582590315204034e-5im; -1.726976222794071e-5 + 2.238076168962618e-6im -9.008036508237247e-6 - 3.588217950269206e-5im … 7.627100773988973e-5 - 1.712401640576924e-5im -1.6756790640720225e-6 + 6.5326155039127855e-6im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -62.277715861368854), converged = true, ρ = [0.0961072013152912 0.09085401337756316 … 0.07655587366905522 0.09085401337847158; 0.0908540133787046 0.08147776990889433 … 0.07647151840837035 0.08747433053331967; … ; 0.07655587366768392 0.07647151840615769 … 0.03956580495550305 0.061384247177075295; 0.09085401337757412 0.08747433053144466 … 0.061384247177553704 0.08147776990864478;;; 0.09085401337813948 0.0814777699084134 … 0.0764715184078289 0.08747433053276017; 0.08147776990942728 0.06246757364720088 … 0.07270707893297607 0.0831614881526055; … ; 0.07647151840657525 0.07270707893100595 … 0.057383084526324166 0.07121914197017001; 0.08747433053197076 0.08316148815092367 … 0.07121914197068088 0.08316148815161882;;; 0.07655587366849427 0.0613842471773637 … 0.06641329348297623 0.07647151840752263; 0.061384247177925906 0.03680319832598064 … 0.06415300528613409 0.07121914197124037; … ; 0.06641329348196964 0.06415300528465927 … 0.057473119211307946 0.064153005284987; 0.07647151840693096 0.07121914197010559 … 0.06415300528543984 0.07270707893187348;;; … ;;; 0.060012815482113284 0.06348370462229641 … 0.029186011399651553 0.04413141881664679; 0.06348370462307605 0.05979446095429893 … 0.04476312021531652 0.05713332556643158; … ; 0.02918601139979571 0.04476312021451918 … 0.015925084145846757 0.015925084145705752; 0.0441314188162386 0.05713332556517451 … 0.015925084145286844 0.024857443206855807;;; 0.07655587366793697 0.07647151840637348 … 0.03956580495581152 0.06138424717740957; 0.07647151840733914 0.07270707893163227 … 0.05738308452732549 0.0712191419711022; … ; 0.03956580495515252 0.0573830845255641 … 0.005337878765132059 0.01592508414550352; 0.06138424717662892 0.07121914196936828 … 0.01592508414538786 0.03680319832542457;;; 0.09085401337787671 0.0874743305316962 … 0.06138424717796273 0.08147776990901845; 0.08747433053278059 0.08316148815161119 … 0.07121914197164841 0.08316148815251707; … ; 0.061384247176733235 0.07121914196943394 … 0.01592508414552796 0.03680319832553478; 0.08147776990809043 0.08316148815062183 … 0.03680319832579941 0.0624675736467532;;;;], eigenvalues = Any[[-0.16217594588286888, -0.07512573394934238, -0.07512573394376273, -0.07512573394279805, -0.07512573394233713, -0.010168114059309282, -0.010168114056573706, -0.010168114055325738, -0.010168114054777296, -0.010168114052678293  …  0.22436299900993006, 0.22436299901005208, 0.22436299901309, 0.22436299901345175, 0.22436299901406195, 0.22436299901521028, 0.22436299901551424, 0.27059897188690846, 0.27059897188723486, 0.2705989718875198]], occupation = [[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0  …  2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]], εF = nothing, n_iter = 4, ψ = Matrix{ComplexF64}[[0.011554364337044681 - 0.9569260961014051im 1.3780986815841844e-12 - 3.212056624369089e-12im … -4.557969069232476e-13 + 1.949702338731882e-12im 8.018432862074259e-12 - 6.2333738028973195e-12im; -8.314620219000875e-13 - 1.8007321436926127e-13im 0.10895048628228132 - 0.2583410776642153im … 2.5557762252847917e-12 - 1.3809765793605005e-12im -2.5730076469237476e-12 - 3.2993658413677353e-12im; … ; 1.3741906409721425e-12 + 1.3532357336478243e-12im 1.073356044344921e-12 - 9.128573248471015e-13im … -1.6730928929511665e-11 + 3.577035540057276e-11im 1.1222065255680168e-10 + 1.1977892631837353e-10im; -1.1902217434713996e-12 - 2.744152080142447e-12im 0.307121911874947 + 0.12951780469498547im … 1.9134937339567225e-12 - 2.819854199063753e-12im -3.682300209109973e-12 + 4.574384538280504e-12im]], stage = :finalize, algorithm = &quot;Newton&quot;)</pre><pre><code class="language-julia">scfres_newton.energies</code></pre><pre class="documenter-example-output">Energy breakdown (in Ha):
    Kinetic             25.7697876
    AtomicLocal         -18.8616201
    AtomicNonlocal      14.8540134
    Ewald               -67.1831486
    PspCorrection       -2.3569765
    Hartree             4.8508714 
    Xc                  -19.3506430

    total               -62.277715861369</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metallic_systems/">« Temperature and metallic systems</a><a class="docs-footer-nextpage" href="../ase/">Creating slabs with ASE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 17 March 2022 08:54">Thursday 17 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
