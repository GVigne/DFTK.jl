<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating supercells with pymatgen · DFTK.jl</title><link rel="canonical" href="https://docs.dftk.org/stable/examples/pymatgen/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DFTK.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../guide/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Introduction to periodic problems</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Density-functional theory</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li class="is-active"><a class="tocitem" href>Creating supercells with pymatgen</a></li><li><a class="tocitem" href="../ase/">Creating slabs with ASE</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Advanced topics</span><ul><li><a class="tocitem" href="../../advanced/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../advanced/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../advanced/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../advanced/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/pymatgen.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Creating-supercells-with-pymatgen"><a class="docs-heading-anchor" href="#Creating-supercells-with-pymatgen">Creating supercells with pymatgen</a><a id="Creating-supercells-with-pymatgen-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-supercells-with-pymatgen" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/pymatgen.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/pymatgen.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>The <a href="https://pymatgen.org/">Pymatgen</a> python library allows to setup solid-state calculations using a flexible set of classes as well as an API to an online data base of structures. Its <code>Structure</code> and <code>Lattice</code> objects are directly supported by the DFTK <code>load_atoms</code> and <code>load_lattice</code> functions, such that DFTK may be readily used to run calculation on systems defined in pymatgen. Using the <code>pymatgen_structure</code> function a conversion from DFTK to pymatgen structures is also possible. In the following we use this to create a silicon supercell and find its LDA ground state using direct minimisation. To run this example Julia&#39;s <code>PyCall</code> package needs to be able to find an installation of <code>pymatgen</code>.</p><p>First we setup the silicon lattice in DFTK.</p><pre><code class="language-julia">using DFTK

a = 10.263141334305942  # Lattice constant in Bohr
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8];</code></pre><p>Next we make a <code>[2, 2, 2]</code> supercell using pymatgen</p><pre><code class="language-julia">pystruct = pymatgen_structure(lattice, atoms, positions)
pystruct.make_supercell([2, 2, 2])
lattice   = load_lattice(pystruct)
positions = load_positions(pystruct)
atoms     = fill(Si, length(positions));</code></pre><p>Setup an LDA model and discretize using a single k-point and a small <code>Ecut</code> of 5 Hartree.</p><pre><code class="language-julia">model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=(1, 1, 1))</code></pre><pre class="documenter-example-output">PlaneWaveBasis discretization:
    Ecut                 : 5.0 Ha
    fft_size             : (32, 32, 32), 32768 total points
    kgrid type           : Monkhorst-Pack
    kgrid                : [1, 1, 1]
    num. irred. kpoints  : 1

    Discretized Model(lda_x+lda_c_pw, 3D):
        lattice (in Bohr)    : [0         , 10.2631   , 10.2631   ]
                               [10.2631   , 0         , 10.2631   ]
                               [10.2631   , 10.2631   , 0         ]
        unit cell volume     : 2162.1 Bohr³
    
        atoms                : Si₁₆
        atom potentials      : ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
    
        num. electrons       : 64
        spin polarization    : none
        temperature          : 0 Ha
    
        terms                : Kinetic()
                               AtomicLocal()
                               AtomicNonlocal()
                               Ewald()
                               PspCorrection()
                               Hartree()
                               Xc([:lda_x, :lda_c_pw])</pre><p>Find the ground state using direct minimisation and newton (always using SCF is boring ...)</p><pre><code class="language-julia">scfres = direct_minimization(basis; tol=1e-3);
ψ, _ = DFTK.select_occupied_orbitals(basis, scfres.ψ, scfres.occupation)
scfres_newton = newton(basis, ψ; tol=1e-12)</code></pre><pre class="documenter-example-output">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3000838204844425 -0.3865167607613796 … -0.6442304016759225 -0.3865167607613762; -0.38651676076137836 -0.768132121776888 … -0.25003406483654445 -0.24218268965121242; … ; -0.6442304016759215 -0.25003406483654483 … -3.0211542861086316 -1.466415348904496; -0.3865167607613758 -0.24218268965121426 … -1.4664153489044964 -0.7681321217768781;;; -0.38651676076138003 -0.7681321217768898 … -0.25003406483654433 -0.24218268965121348; -0.7681321217768886 -1.8161936706060204 … -0.13699557143111202 -0.31298842049396153; … ; -0.25003406483654467 -0.13699557143111366 … -0.9870510298301364 -0.527775915384607; -0.24218268965121384 -0.3129884204939632 … -0.527775915384607 -0.31298842049395803;;; -0.6442304016759322 -1.4664153489045144 … -0.088313570314389 -0.25003406483654844; -1.466415348904513 -4.114878101698642 … -0.1404089232404591 -0.5277759153846142; … ; -0.08831357031439022 -0.14040892324046036 … -0.26983750242606713 -0.1404089232404561; -0.2500340648365487 -0.527775915384615 … -0.14040892324045487 -0.13699557143111132;;; … ;;; -0.9859863776629685 -0.3582474485160946 … -4.090627806711927 -2.290246635945571; -0.3582474485160946 -0.08635610801077073 … -1.4293432742461816 -0.8160371791714963; … ; -4.090627806711926 -1.4293432742461822 … -8.358403967979397 -8.331633709105212; -2.29024663594557 -0.8160371791714961 … -8.33163370910521 -5.7704684544717795;;; -0.6442304016759224 -0.2500340648365443 … -3.021154286108632 -1.4664153489044973; -0.2500340648365441 -0.13699557143111132 … -0.9870510298301357 -0.5277759153846076; … ; -3.021154286108632 -0.9870510298301353 … -12.395558685839045 -8.358412346516113; -1.4664153489044964 -0.5277759153846068 … -8.358412346516113 -4.114878101698613;;; -0.38651676076137653 -0.24218268965121348 … -1.4664153489044973 -0.7681321217768792; -0.24218268965121248 -0.3129884204939609 … -0.5277759153846076 -0.3129884204939583; … ; -1.4664153489044955 -0.5277759153846068 … -8.358412346516111 -4.114878101698615; -0.768132121776878 -0.3129884204939586 … -4.114878101698614 -1.816193670605997]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035007im 0.05414494805835375 - 0.0224275718197569im … 0.003755074015300082 - 0.00906555061545225im -0.003755074015300082 + 0.00906555061545225im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 7.962118806259657e-18im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.00906555061545225 + 0.003755074015300082im 0.00906555061545225 + 0.003755074015300082im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.414753743163458 0.39667717339567243 … 0.3515373566264022 0.3966771733946769; 0.39667717339717845 0.3789391676642541 … 0.32946849923562227 0.3773084908116076; … ; 0.35153735662392066 0.32946849923250554 … 0.3055322803078919 0.3369272441379241; 0.39667717339351083 0.37730849080924694 … 0.33692724413943526 0.378939167660093;;; 0.39667717339584313 0.37893916766294294 … 0.32946849923487254 0.377308490810462; 0.37893916766521446 0.3562927712382312 … 0.30816723398051615 0.36133865102442886; … ; 0.32946849923164195 0.3081672339760576 … 0.29252956934742447 0.32135530619475533; 0.37730849080880136 0.36133865102081786 … 0.321355306196665 0.3613386510198664;;; 0.3515373566290985 0.3369272441430444 … 0.2762473056984378 0.32946849923653687; 0.33692724414576986 0.3170936258947927 … 0.2653418753151777 0.3213553062028749; … ; 0.2762473056948774 0.2653418753097638 … 0.23782576132607358 0.2653418753084595; 0.3294684992345244 0.3213553061983468 … 0.26534187531039793 0.30816723397761664;;; … ;;; 0.3043050825360073 0.27477283611113223 … 0.28977472646364255 0.30205476270886933; 0.2747728361100363 0.24249812764299636 … 0.2670898552730506 0.27937033527261407; … ; 0.28977472646689384 0.26708985527723506 … 0.2926353972840157 0.292635397283317; 0.3020547627104546 0.2793703352752499 … 0.29263539728152566 0.2981166266504085;;; 0.351537356627373 0.3294684992362514 … 0.3055322803088636 0.33692724414036923; 0.32946849923603355 0.3081672339806908 … 0.29252956934907615 0.3213553061981284; … ; 0.3055322803099437 0.29252956935044094 … 0.28354300367317625 0.2926353972808011; 0.3369272441408847 0.3213553061989175 … 0.29263539728015336 0.31709362589013734;;; 0.3966771733951999 0.3773084908110158 … 0.33692724414008296 0.3789391676614023; 0.3773084908116689 0.36133865102376356 … 0.3213553061980155 0.36133865102220714; … ; 0.33692724413905734 0.32135530619680697 … 0.29263539727982435 0.31709362588900347; 0.3789391676609473 0.3613386510212983 … 0.31709362588960394 0.3562927712339297]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.5113149641925726 -0.5025077544811198 … -0.47663248325690655 -0.502507754481125; -0.5025077544814555 -0.48588487145952014 … -0.4764704240155575 -0.4966568013389986; … ; -0.47663248325566177 -0.47647042401467826 … -0.3891035353036436 -0.44527691908172995; -0.5025077544808076 -0.49665680133856754 … -0.4452769190829743 -0.48588487145883413;;; -0.5025077544809425 -0.48588487145887505 … -0.47647042401531 -0.49665680133858836; -0.48588487145972525 -0.44768088614506474 … -0.4691108988256708 -0.4889624560171252; … ; -0.47647042401419093 -0.4691108988245609 … -0.43613878734851397 -0.4661303640477684; -0.49665680133817913 -0.4889624560161383 … -0.46613036404880226 -0.4889624560160718;;; -0.4766324832568318 -0.4452769190828211 … -0.4562036919112378 -0.47647042401540735; -0.4452769190843182 -0.3805736265915927 … -0.4513650797561979 -0.4661303640503411; … ; -0.45620369191023885 -0.45136507975461077 … -0.4363491190497615 -0.45136507975413465; -0.4764704240148162 -0.4661303640485562 … -0.45136507975489343 -0.46911089882477097;;; … ;;; -0.44219177355913686 -0.44991004399489887 … -0.35452296199739697 -0.4023490353959185; -0.4499100439942016 -0.4416961440268083 … -0.40410681005610194 -0.4355541400362535; … ; -0.35452296200054967 -0.4041068100591209 … -0.29480061879434327 -0.2948006187946694; -0.40234903539722267 -0.4355541400380066 … -0.29480061879225616 -0.33757346153736667;;; -0.4766324832575669 -0.4764704240164135 … -0.38910353530398534 -0.44527691908336686; -0.4764704240161097 -0.46911089882642687 … -0.4361387873491325 -0.4661303640494325; … ; -0.3891035353045426 -0.43613878734992845 … -0.21186524619100086 -0.2948006187931204; -0.445276919083711 -0.46613036405007213 … -0.2948006187927166 -0.38057362659109817;;; -0.5025077544815254 -0.4966568013392557 … -0.4452769190832362 -0.48588487145947945; -0.4966568013392491 -0.4889624560173143 … -0.4661303640492712 -0.4889624560169935; … ; -0.44527691908231176 -0.466130364048821 … -0.29480061879288033 -0.38057362658993504; -0.4858848714593277 -0.48896245601698746 … -0.38057362659101734 -0.44768088614478485])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3966450415135571 -0.492347341846827 … -0.7693255283064269 -0.49234734184782425; -0.4923473418456554 -0.8750778255721541 … -0.3970359896164797 -0.3615310001786034; … ; -0.7693255283076625 -0.39703598961871756 … -3.1047255411043833 -1.5747650238483017; -0.4923473418486726 -0.36153100018053486 … -1.5747650238480353 -0.8750778255756192;;; -0.49234734184647944 -0.875077825572822 … -0.3970359896169818 -0.3615310001793398; -0.8750778255713993 -1.907581785512854 … -0.2979392362762667 -0.44061222548665785; … ; -0.39703598961909364 -0.29793923627961694 … -1.130660247831226 -0.67255097323762; -0.3615310001805916 -0.44061222548928364 … -0.6725509732367443 -0.44061222549016343;;; -0.7693255283036654 -1.5747650238442912 … -0.268269956527189 -0.3970359896154189; -1.5747650238430615 -4.178358102395443 … -0.3264321276814792 -0.6725509732320805; … ; -0.2682699565297517 -0.3264321276853074 … -0.46836086014975503 -0.3264321276861313; -0.3970359896168405 -0.6725509732348244 … -0.32643212768495034 -0.2979392362782657;;; … ;;; -1.123873068686098 -0.5333846563998612 … -4.155376042245681 -2.3905409086326204; -0.5333846564002599 -0.28555412439458266 … -1.5663602290292329 -0.9722209839351357; … ; -4.155376042245582 -1.5663602290280683 … -8.360569189489723 -8.333798930616565; -2.3905409086323384 -0.9722209839342528 … -8.333798930615941 -5.809925289358738;;; -0.7693255283061162 -0.3970359896167064 … -3.104725541103754 -1.5747650238474948; -0.39703598961662023 -0.2979392362768474 … -1.1306602478301921 -0.6725509732359116; … ; -3.104725541103231 -1.1306602478296228 … -12.323880928356871 -8.360577568028432; -1.5747650238473228 -0.6725509732357614 … -8.360577568028678 -4.178358102399574;;; -0.492347341847702 -0.3615310001794534 … -1.5747650238476505 -0.8750778255749563; -0.3615310001787927 -0.44061222548751167 … -0.6725509732358632 -0.4406122254887447; … ; -1.57476502384775 -0.6725509732366208 … -8.360577568029168 -4.178358102399546; -0.8750778255752583 -0.44061222548964774 … -4.178358102400027 -1.907581785516852]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035007im 0.05414494805835375 - 0.0224275718197569im … 0.003755074015300082 - 0.00906555061545225im -0.003755074015300082 + 0.00906555061545225im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 7.962118806259657e-18im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.00906555061545225 + 0.003755074015300082im 0.00906555061545225 + 0.003755074015300082im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[7.942840335136477e-8 + 5.346715949213366e-7im 6.42438161874682e-6 + 1.1439601527109065e-5im … -0.02281689033780697 + 0.018707863741031255im 4.975426717337374e-6 + 7.788489773766518e-6im; 5.693943200434497e-6 + 1.996689610250355e-6im -1.0409313062575732e-5 + 4.0182180530428405e-6im … 7.758624753340281e-7 - 2.1897933160044186e-6im -1.5978871066184638e-5 + 1.3198923913133432e-6im; … ; -0.07882995888714237 - 0.16504536252670757im 6.85007357060961e-6 + 1.2224104936970514e-5im … -0.11872456107150042 - 0.17092423286814806im 8.721029461965616e-6 + 1.4994784535674502e-5im; 5.178162097552402e-7 + 4.571111297534744e-6im 1.263177068334191e-5 - 6.102961530905597e-6im … -6.350159983181122e-6 - 5.3346086590080814e-6im 7.338904298096315e-6 - 8.405900220168251e-6im;;; 1.2524852248065031e-6 - 3.268813186069822e-6im 4.196913372816174e-6 - 5.064989292610294e-7im … 2.508319138465907e-6 - 5.913950640663146e-6im -2.970344751186118e-8 + 1.1970934277605199e-6im; 3.9045166363603476e-6 + 2.7757083555054045e-6im -2.0054896347636984e-6 + 8.271626047121248e-6im … 2.18318104876909e-6 + 2.4441745015726036e-6im -1.9880909643248935e-5 + 1.1917674391316962e-5im; … ; 8.011255490290879e-6 + 1.6936441049881684e-5im 2.4295429052755173e-6 + 8.569261593246321e-7im … 1.417146150262905e-5 + 2.1539732459767214e-5im 2.401208472585625e-6 + 7.229701341359792e-6im; -5.175344431454356e-7 + 5.268525731080407e-6im 4.888429548734374e-5 - 1.1876424508457072e-5im … 8.781899294631167e-7 + 4.584686549596212e-6im 3.0582507968520775e-5 - 9.411194267289963e-6im;;; 0.007283524665964948 + 0.013198844673514945im 1.7506359689929413e-5 + 2.214920546598689e-5im … -0.004491355956674918 + 0.009225618176632637im 9.447868234339909e-6 + 1.2114606051844055e-5im; 1.3937091655477896e-5 + 1.3943800945794018e-5im -1.3268327000183064e-5 + 1.465382518420218e-6im … 6.313570933161324e-6 + 6.555823331170286e-6im -1.4919441279432744e-5 + 4.989525602919592e-7im; … ; -0.02068712742004296 - 0.04390529102655452im 7.49171151171262e-6 + 9.699850342759832e-6im … -0.050549060834999014 - 0.07326823519428213im 3.6369969569961112e-6 + 6.727709187900452e-6im; 5.1268100775078486e-6 + 8.691714947572971e-6im 2.7765161850988595e-6 - 4.092153586619943e-6im … -2.4641495288063956e-6 - 2.2917313769878343e-6im 2.0433227968046297e-6 - 4.194487332661566e-6im;;; … ;;; -3.1995342776878638e-6 + 6.737552129458435e-7im 6.048488932359778e-7 + 5.464361333464575e-7im … 2.6711436810767387e-6 - 5.904960397202703e-6im -1.5746037220877862e-6 + 1.1898806996920376e-6im; 1.2896830846238836e-6 + 1.6049861238524227e-6im -1.7428844572667322e-5 + 1.3860005071575565e-5im … 1.0415381563073548e-6 + 1.915331284359483e-6im -1.5675050741710836e-5 + 9.570675145852902e-6im; … ; 1.090212684160169e-5 + 2.8273372135968974e-5im 1.866534601097441e-6 + 4.908225024288048e-6im … 1.1750463276235809e-5 + 1.474978785725486e-5im 1.4878396346704566e-6 + 6.628083865925655e-6im; -1.287628712850854e-6 + 2.4666880901623807e-6im 1.1151519761520453e-5 + 2.8815625511913124e-7im … -1.428508339467763e-7 + 1.5538793022012836e-6im 1.5357542411543078e-5 - 6.3239173403058775e-6im;;; 0.0072835246705296435 + 0.013198844661754154im 9.981910881569397e-6 + 1.346031287846131e-5im … -0.018143215911744132 + 0.03726664950362774im 1.5771540089981004e-5 + 1.7777774567925566e-5im; 7.034614611044434e-6 + 7.742830611609438e-6im -4.626912156202295e-6 + 4.7478731184931434e-7im … 2.9200828727413913e-6 + 4.825493539864844e-6im -8.358118038021479e-6 - 4.0941296845259744e-6im; … ; -0.0835669979884733 - 0.17735881809611617im 1.4882004810403312e-5 + 2.0186145447584128e-5im … -0.0943634977837923 - 0.1331398201702343im 1.932797338226787e-5 + 2.4784072590387936e-5im; 7.739793357433363e-6 + 1.7026110120981675e-5im 9.337839682168463e-6 - 8.685236252696618e-6im … 1.2014398348042929e-6 + 6.6751092906093465e-6im 6.0792681779249325e-6 - 1.2078345801550026e-5im;;; -3.8079723085086057e-6 - 5.398203606794245e-7im 2.722987084757239e-6 + 5.768657328171583e-7im … 1.6907244545422556e-6 - 8.799960444723595e-6im -1.726270983836672e-6 + 2.1338011042349635e-6im; 3.528327337760292e-6 + 3.6684676996919924e-6im -2.1225896338745235e-5 + 2.1449139719372733e-5im … 3.3805936452301283e-6 + 3.595035727941035e-6im -3.9527682789252766e-5 + 2.3914375422856392e-5im; … ; 1.4079150730544066e-5 + 4.2641737929238745e-5im 4.103774859828721e-6 + 6.846085234601864e-6im … 2.0151477036211237e-5 + 3.4223359883213034e-5im 3.06193613975325e-6 + 1.1542501124669781e-5im; -1.1426083650832314e-6 + 5.4224926292154644e-6im 2.923752247227796e-5 + 1.2027260250035323e-7im … 1.3747570000209114e-6 + 4.813993625840318e-6im 9.820340659093503e-6 + 1.7827603515636288e-6im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -62.27771586136885), converged = true, ρ = [0.09610720131590997 0.09085401337849376 … 0.07655587366846014 0.09085401337849679; 0.09085401337869016 0.08147776990901849 … 0.0764715184075451 0.0874743305329822; … ; 0.07655587366781197 0.07647151840708764 … 0.039565804955014515 0.06138424717655428; 0.09085401337831112 0.08747433053273644 … 0.061384247177111655 0.08147776990864579;;; 0.09085401337838998 0.08147776990866805 … 0.0764715184074163 0.0874743305327483; 0.08147776990912994 0.06246757364690728 … 0.07270707893238271 0.08316148815224149; … ; 0.07647151840683403 0.0727070789318247 … 0.057383084525719226 0.07121914196977962; 0.08747433053251497 0.08316148815169785 … 0.0712191419702921 0.08316148815166123;;; 0.07655587366842122 0.06138424717704306 … 0.06641329348271058 0.07647151840746699; 0.06138424717771371 0.03680319832568927 … 0.06415300528580861 0.07121914197105492; … ; 0.06641329348223843 0.06415300528507593 … 0.0574731192108972 0.06415300528485614; 0.07647151840715939 0.07121914197017012 … 0.0641530052852064 0.07270707893193035;;; … ;;; 0.06001281548279122 0.06348370462379586 … 0.02918601139915954 0.04413141881643421; 0.06348370462347626 0.0597944609554953 … 0.04476312021405366 0.057133325565767806; … ; 0.029186011400009364 0.044763120215143865 … 0.015925084145605298 0.01592508414566333; 0.04413141881690061 0.05713332556651561 … 0.01592508414523399 0.024857443206952438;;; 0.07655587366880401 0.07647151840799049 … 0.03956580495512794 0.06138424717728753; 0.07647151840783241 0.0727070789327628 … 0.057383084525983834 0.0712191419706045; … ; 0.03956580495531292 0.05738308452632439 … 0.005337878765094123 0.015925084145387743; 0.06138424717744168 0.07121914197092155 … 0.015925084145315915 0.03680319832553305;;; 0.09085401337873106 0.08747433053312886 … 0.06138424717722902 0.08147776990899637; 0.08747433053312506 0.0831614881523457 … 0.07121914197052455 0.08316148815216896; … ; 0.06138424717681492 0.07121914197030141 … 0.015925084145345037 0.03680319832516561; 0.08147776990891395 0.0831614881521656 … 0.036803198325507526 0.0624675736467804;;;;], eigenvalues = Any[[-0.16217594588359463, -0.07512573394660768, -0.07512573394533947, -0.07512573394522018, -0.07512573394463565, -0.010168114056798272, -0.010168114056548399, -0.01016811405629131, -0.010168114056023065, -0.010168114055680674  …  0.22436299901091142, 0.22436299901121134, 0.22436299901139703, 0.22436299901154383, 0.22436299901183282, 0.22436299901249598, 0.22436299901272402, 0.27059897188569737, 0.2705989718861138, 0.2705989718866241]], occupation = [[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0  …  2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]], εF = nothing, n_iter = 3, ψ = Matrix{ComplexF64}[[0.14062537581677192 + 0.9466073950768608im 1.528469154222405e-12 + 1.9938276561454887e-12im … -4.2293116973131183e-13 - 9.905319483289075e-13im -6.315970056156126e-14 - 1.118427210972307e-12im; 2.7110241541906596e-12 + 7.682282219222125e-12im 0.276131206069245 + 0.3583716571314727im … 2.132352993467992e-12 - 3.352874398341579e-13im 3.247619634696476e-12 + 7.356122004933963e-14im; … ; -5.256805411026641e-13 + 9.59289793884692e-13im 1.4324732060797853e-12 + 3.762962757011953e-14im … 8.6534322899835e-12 + 5.403054770220872e-12im -1.7467703667055058e-11 + 1.856423898441851e-11im; 7.520813818465053e-12 + 7.237928766009519e-13im -0.045144388819015405 + 0.03477971381528387im … 4.550303586885561e-12 - 3.2842624921999556e-12im -6.296456226170869e-12 + 5.834316646996718e-12im]], stage = :finalize, algorithm = &quot;Newton&quot;)</pre><pre><code class="language-julia">scfres_newton.energies</code></pre><pre class="documenter-example-output">Energy breakdown (in Ha):
    Kinetic             25.7697876
    AtomicLocal         -18.8616201
    AtomicNonlocal      14.8540134
    Ewald               -67.1831486
    PspCorrection       -2.3569765
    Hartree             4.8508714 
    Xc                  -19.3506430

    total               -62.277715861369</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metallic_systems/">« Temperature and metallic systems</a><a class="docs-footer-nextpage" href="../ase/">Creating slabs with ASE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 14 March 2022 19:57">Monday 14 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
