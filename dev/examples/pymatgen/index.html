<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Creating supercells with pymatgen · DFTK.jl</title><link rel="canonical" href="https://docs.dftk.org/stable/examples/pymatgen/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">DFTK.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/input_output/">Input and output formats</a></li><li><a class="tocitem" href="../../guide/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Introduction to periodic problems</a></li><li><a class="tocitem" href="../../guide/density_functional_theory/">Density-functional theory</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li class="is-active"><a class="tocitem" href>Creating supercells with pymatgen</a></li><li><a class="tocitem" href="../ase/">Creating slabs with ASE</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Advanced topics</span><ul><li><a class="tocitem" href="../../advanced/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../advanced/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../advanced/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../advanced/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Creating supercells with pymatgen</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/pymatgen.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Creating-supercells-with-pymatgen"><a class="docs-heading-anchor" href="#Creating-supercells-with-pymatgen">Creating supercells with pymatgen</a><a id="Creating-supercells-with-pymatgen-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-supercells-with-pymatgen" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/pymatgen.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/pymatgen.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>The <a href="https://pymatgen.org/">Pymatgen</a> python library allows to setup solid-state calculations using a flexible set of classes as well as an API to an online data base of structures. Its <code>Structure</code> and <code>Lattice</code> objects are directly supported by the DFTK <code>load_atoms</code> and <code>load_lattice</code> functions, such that DFTK may be readily used to run calculation on systems defined in pymatgen. Using the <code>pymatgen_structure</code> function a conversion from DFTK to pymatgen structures is also possible. In the following we use this to create a silicon supercell and find its LDA ground state using direct minimisation. To run this example Julia&#39;s <code>PyCall</code> package needs to be able to find an installation of <code>pymatgen</code>.</p><p>First we setup the silicon lattice in DFTK.</p><pre><code class="language-julia">using DFTK

a = 10.263141334305942  # Lattice constant in Bohr
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8];</code></pre><p>Next we make a <code>[2, 2, 2]</code> supercell using pymatgen</p><pre><code class="language-julia">pystruct = pymatgen_structure(lattice, atoms, positions)
pystruct.make_supercell([2, 2, 2])
lattice   = load_lattice(pystruct)
positions = load_positions(pystruct)
atoms     = fill(Si, length(positions));</code></pre><p>Setup an LDA model and discretize using a single k-point and a small <code>Ecut</code> of 5 Hartree.</p><pre><code class="language-julia">model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=(1, 1, 1))</code></pre><pre class="documenter-example-output">PlaneWaveBasis discretization:
    Ecut                 : 5.0 Ha
    fft_size             : (32, 32, 32), 32768 total points
    kgrid type           : Monkhorst-Pack
    kgrid                : [1, 1, 1]
    num. irred. kpoints  : 1

    Discretized Model(lda_x+lda_c_pw, 3D):
        lattice (in Bohr)    : [0         , 10.2631   , 10.2631   ]
                               [10.2631   , 0         , 10.2631   ]
                               [10.2631   , 10.2631   , 0         ]
        unit cell volume     : 2162.1 Bohr³
    
        atoms                : Si₁₆
        atom potentials      : ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
                               ElementPsp(Si, psp=&quot;hgh/lda/si-q4&quot;)
    
        num. electrons       : 64
        spin polarization    : none
        temperature          : 0 Ha
    
        terms                : Kinetic()
                               AtomicLocal()
                               AtomicNonlocal()
                               Ewald()
                               PspCorrection()
                               Hartree()
                               Xc([:lda_x, :lda_c_pw])</pre><p>Find the ground state using direct minimisation and newton (always using SCF is boring ...)</p><pre><code class="language-julia">scfres = direct_minimization(basis; tol=1e-3);
ψ, _ = DFTK.select_occupied_orbitals(basis, scfres.ψ, scfres.occupation)
scfres_newton = newton(basis, ψ; tol=1e-12)</code></pre><pre class="documenter-example-output">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3000838204844399 -0.38651676076137903 … -0.6442304016759204 -0.38651676076137265; -0.38651676076137914 -0.768132121776889 … -0.2500340648365427 -0.24218268965121173; … ; -0.6442304016759205 -0.25003406483654256 … -3.0211542861086325 -1.4664153489044962; -0.3865167607613723 -0.24218268965121167 … -1.466415348904496 -0.7681321217768756;;; -0.3865167607613794 -0.7681321217768898 … -0.25003406483654234 -0.24218268965121173; -0.7681321217768898 -1.8161936706060218 … -0.13699557143111138 -0.312988420493962; … ; -0.25003406483654256 -0.1369955714311113 … -0.9870510298301364 -0.5277759153846058; -0.24218268965121126 -0.3129884204939619 … -0.5277759153846058 -0.3129884204939551;;; -0.6442304016759322 -1.4664153489045144 … -0.08831357031438808 -0.25003406483654783; -1.4664153489045144 -4.114878101698644 … -0.14040892324045914 -0.5277759153846148; … ; -0.08831357031438869 -0.14040892324045884 … -0.26983750242606713 -0.14040892324045487; -0.2500340648365478 -0.5277759153846147 … -0.14040892324045426 -0.1369955714311098;;; … ;;; -0.9859863776629684 -0.35824744851609447 … -4.090627806711926 -2.29024663594557; -0.3582474485160943 -0.08635610801077073 … -1.4293432742461814 -0.8160371791714962; … ; -4.090627806711926 -1.4293432742461816 … -8.358403967979397 -8.33163370910521; -2.29024663594557 -0.8160371791714959 … -8.33163370910521 -5.7704684544717795;;; -0.6442304016759217 -0.25003406483654367 … -3.021154286108632 -1.466415348904497; -0.25003406483654367 -0.13699557143111163 … -0.9870510298301353 -0.5277759153846068; … ; -3.021154286108632 -0.9870510298301354 … -12.395558685839045 -8.358412346516113; -1.4664153489044969 -0.5277759153846068 … -8.358412346516113 -4.114878101698615;;; -0.3865167607613733 -0.24218268965121195 … -1.4664153489044964 -0.7681321217768768; -0.24218268965121206 -0.31298842049396153 … -0.5277759153846063 -0.3129884204939567; … ; -1.4664153489044964 -0.5277759153846062 … -8.358412346516115 -4.114878101698615; -0.7681321217768764 -0.3129884204939567 … -4.114878101698615 -1.8161936706059967]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.41475374316815355 0.39667717340115094 … 0.3515373566302571 0.3966771733988726; 0.39667717340044995 0.37893916766854585 … 0.3294684992375922 0.37730849081413353; … ; 0.3515373566316781 0.3294684992397816 … 0.30553228031597174 0.3369272441459943; 0.39667717339958164 0.3773084908155395 … 0.33692724414544 0.3789391676661345;;; 0.3966771734003532 0.3789391676687363 … 0.32946849923821325 0.3773084908141888; 0.378939167667512 0.3562927712420113 … 0.3081672339814649 0.3613386510258245; … ; 0.3294684992392715 0.3081672339837114 … 0.29252956935548236 0.32135530620262454; 0.37730849081494594 0.3613386510277861 … 0.32135530620239244 0.36133865102566076;;; 0.35153735663184843 0.3369272441474012 … 0.27624730570014755 0.3294684992384414; 0.3369272441454608 0.3170936258964523 … 0.2653418753138224 0.3213553062016085; … ; 0.2762473057013907 0.26534187531687903 … 0.23782576133284195 0.2653418753149491; 0.32946849923951826 0.32135530620459557 … 0.26534187531477027 0.30816723398203044;;; … ;;; 0.30430508253973615 0.2747728361133196 … 0.2897747264686978 0.30205476271374904; 0.2747728361128494 0.24249812764442483 … 0.26708985527732987 0.2793703352766185; … ; 0.2897747264714773 0.267089855281196 … 0.29263539728902077 0.29263539728810145; 0.3020547627149367 0.27937033527840477 … 0.29263539728686816 0.29811662665565686;;; 0.3515373566307135 0.3294684992388739 … 0.3055322803130035 0.3369272441443507; 0.32946849923842636 0.30816723398267126 … 0.29252956935193203 0.3213553062009519; … ; 0.30553228031580393 0.2925295693555631 … 0.28354300367941515 0.2926353972868999; 0.3369272441455009 0.3213553062025995 … 0.2926353972855727 0.3170936258953799;;; 0.3966771733991425 0.3773084908150575 … 0.3369272441439271 0.3789391676653533; 0.37730849081459095 0.3613386510271014 … 0.32135530620030384 0.3613386510248395; … ; 0.33692724414608777 0.32135530620312286 … 0.2926353972870876 0.3170936258962867; 0.3789391676662545 0.36133865102621754 … 0.31709362589527496 0.35629277123954195]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.5113149641936641 -0.5025077544826069 … -0.4766324832569962 -0.5025077544817499; -0.5025077544826854 -0.48588487146106546 … -0.47647042401566264 -0.49665680133974327; … ; -0.4766324832572259 -0.4764704240158388 … -0.38910353530549596 -0.4452769190836049; -0.502507754481787 -0.4966568013397096 … -0.44527691908358014 -0.4858848714596692;;; -0.502507754482604 -0.4858848714611643 … -0.47647042401592404 -0.49665680133971724; -0.48588487146097054 -0.44768088614684526 … -0.4691108988260664 -0.4889624560179756; … ; -0.4764704240159048 -0.4691108988262365 … -0.43613878735065703 -0.46613036404972247; -0.49665680133977 -0.48896245601822613 … -0.4661303640498773 -0.4889624560173528;;; -0.47663248325815966 -0.44527691908502315 … -0.4562036919118234 -0.4764704240162901; -0.4452769190842207 -0.3805736265923122 … -0.451365079756025 -0.46613036405013575; … ; -0.4562036919118622 -0.45136507975667367 … -0.43634911905153534 -0.45136507975573464; -0.476470424016516 -0.46613036405106395 … -0.4513650797559307 -0.46911089882602797;;; … ;;; -0.4421917735585005 -0.44991004399334106 … -0.35452296199844036 -0.4023490353964546; -0.44991004399349915 -0.4416961440253153 … -0.40410681005672483 -0.43555414003649806; … ; -0.354522962000404 -0.40410681005864457 … -0.2948006187955908 -0.2948006187948643; -0.4023490353968974 -0.43555414003676757 … -0.2948006187938728 -0.3375734615382894;;; -0.47663248325675484 -0.4764704240153948 … -0.38910353530313974 -0.44527691908274813; -0.4764704240155534 -0.46911089882574103 … -0.436138787348443 -0.46613036404897484; … ; -0.3891035353049225 -0.43613878734989575 … -0.21186524619205727 -0.2948006187936087; -0.4452769190831168 -0.46613036404912384 … -0.2948006187922505 -0.3805736265907825;;; -0.5025077544815885 -0.49665680133948314 … -0.44527691908256517 -0.4858848714592857; -0.49665680133964607 -0.4889624560178844 … -0.4661303640487677 -0.48896245601704147; … ; -0.4452769190834012 -0.4661303640494099 … -0.2948006187938757 -0.3805736265912102; -0.4858848714594411 -0.48896245601700805 … -0.38057362659074123 -0.44768088614487406])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [0.0, 0.14054984958423578, 0.5621993983369431, 1.264948646258122, 2.2487975933477724, 3.513746239605895, 3.513746239605895, 2.2487975933477724, 1.264948646258122, 0.5621993983369431  …  1.1243987966738864, 2.014547844040713, 3.185796590576011, 4.638145036279781, 4.12279558780425, 2.7641470418233043, 1.6865981950108295, 0.8901490473668268, 0.37479959889129544, 0.14054984958423578]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), [-0.3966450415099504 -0.49234734184283496 … -0.7693255283026594 -0.49234734184424994; -0.49234734184361456 -0.8750778255694087 … -0.39703598961461317 -0.3615310001768215; … ; -0.7693255283014683 -0.3970359896125997 … -3.1047255410981567 -1.5747650238421067; -0.49234734184357765 -0.36153100017538176 … -1.574765023842636 -0.8750778255704104;;; -0.4923473418436302 -0.8750778255693179 … -0.3970359896142531 -0.3615310001767401; -0.8750778255703484 -1.9075817855108559 … -0.29793923627571284 -0.4406122254861131; … ; -0.3970359896131758 -0.29793923627363644 … -1.1306602478253112 -0.6725509732317037; -0.36153100017603534 -0.44061222548440193 … -0.6725509732320907 -0.4406122254856471;;; -0.7693255283022433 -1.5747650238421365 … -0.26826995652606395 -0.3970359896143965; -1.5747650238432744 -4.178358102394504 … -0.3264321276826617 -0.6725509732331421; … ; -0.2682699565248602 -0.3264321276802535 … -0.4683608601447605 -0.3264321276812404; -0.3970359896135455 -0.672550973231083 … -0.32643212768161467 -0.2979392362751073;;; … ;;; -1.1238730686817329 -0.533384656396116 … -4.155376042241669 -2.390540908628276; -0.533384656396744 -0.2855541243916612 … -1.5663602290255763 -0.9722209839313758; … ; -4.155376042240853 -1.5663602290236303 … -8.360569189485968 -8.333798930611973; -2.390540908627531 -0.9722209839298586 … -8.333798930612215 -5.809925289354412;;; -0.7693255283019631 -0.3970359896130646 … -3.104725541098768 -1.5747650238428945; -0.3970359896136707 -0.2979392362741814 … -1.1306602478266463 -0.6725509732326298; … ; -3.104725541097751 -1.1306602478244678 … -12.323880928351686 -8.360577568022823; -1.5747650238421127 -0.6725509732311311 … -8.36057756802279 -4.178358102394018;;; -0.4923473418438193 -0.36153100017563755 … -1.5747650238431345 -0.8750778255708093; -0.36153100017626716 -0.44061222548474455 … -0.6725509732330701 -0.4406122254861587; … ; -1.5747650238418098 -0.6725509732308932 … -8.360577568022903 -4.178358102393538; -0.875077825570063 -0.4406122254847472 … -4.178358102394081 -1.9075817855113288]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =  1139), ComplexF64[0.039452912441695784 + 0.0im 0.061120189138426866 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.035545620743758055 - 0.014723478195035009im 0.05414494805835375 - 0.022427571819756905im … 0.0037550740153000865 - 0.009065550615452249im -0.0037550740153000865 + 0.009065550615452249im; … ; 2.259285387562093e-18 + 0.036896930431453305im 3.3437812305071837e-18 + 0.054608091620134955im … -0.018575895426229238 + 4.09595376946258e-17im 0.0 - 0.0im; 0.014723478195035012 + 0.035545620743758055im 0.022427571819756905 + 0.05414494805835375im … 0.009065550615452257 + 0.003755074015300066im 0.009065550615452257 + 0.003755074015300066im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[7.375220892206005e-7 + 1.8025441976717016e-7im 3.187368451624338e-6 - 1.1310828480773855e-6im … 0.12034397146202458 + 0.010905197982053005im 4.41604458472942e-6 - 2.481690277632852e-6im; 1.1129132404019454e-6 - 6.452166921466705e-6im -5.471152960983102e-6 - 1.2329819786763758e-5im … 1.3516747911836505e-5 - 6.933937542365332e-6im -9.99370171982932e-6 + 4.986519688826348e-6im; … ; 0.08588495078753072 - 0.06821911429974839im 9.55313543998977e-6 - 5.811890143135224e-6im … 0.24087634901904575 - 0.0669434138765668im 1.9262316611957002e-5 - 1.2794862304340745e-5im; 4.147646625975148e-6 - 7.125140800899556e-7im -3.6698519559159074e-6 - 1.4787394557252453e-5im … 3.1091042490842744e-5 - 6.50467456370397e-6im -7.06289025477782e-6 + 3.3391282572475427e-6im;;; 7.997147378534261e-7 - 5.813434118078831e-6im 3.38210386483262e-6 - 1.707631768839126e-5im … -2.009825996306045e-5 - 1.092791631990716e-5im 1.6696965262938802e-6 + 2.7196954972980803e-6im; 1.042350771613382e-5 + 8.757097514620257e-6im -1.7730957822394296e-5 - 3.163311536065879e-6im … 5.568055145346002e-6 + 3.5539022482554707e-6im -1.976946222452809e-5 - 3.476911659406159e-5im; … ; 8.215863744233918e-6 + 1.8719374444618105e-6im 8.14019535456624e-8 - 8.112028050525056e-6im … -2.0566398174974996e-5 - 5.379097182329976e-6im -1.5257282422357983e-5 + 1.2646760218180765e-5im; -8.552233702331996e-6 - 1.3517481621743539e-5im -6.555063809111348e-5 - 4.2916080681537345e-5im … -2.6786599572288037e-6 - 1.1004007050280097e-5im -6.425837505560899e-5 - 7.351264086237246e-5im;;; -0.08596181425056346 + 0.1030053400971261im -7.586693742212501e-6 + 2.3121307937656336e-5im … 0.00994138585022322 + 0.032936412359578233im -1.2668883988940201e-6 + 8.925951093333464e-6im; -1.950089531343522e-5 + 1.8513310408865397e-5im -9.633472540820202e-6 - 1.251809252592485e-5im … -8.795396607434848e-6 + 7.030577891985335e-6im -1.0473315785811562e-5 - 9.032066776951981e-7im; … ; -2.2189405576273765e-5 + 0.010058192820757518im -3.247861849263244e-6 + 9.348848022069991e-6im … 0.1155289483807644 - 0.046523774590309236im 8.748809379588013e-6 - 6.7190239090036666e-6im; -6.223656249453291e-6 + 9.347106691249936e-6im -6.561953796882425e-6 - 1.3133563466392385e-5im … 1.3761484408762147e-5 - 4.613162937421152e-6im -5.232267865176354e-6 - 3.043368858875661e-7im;;; … ;;; 1.2116955706772014e-5 + 7.665967781865787e-6im 2.333034558131807e-6 - 1.009789542587013e-5im … -3.0973951418110165e-5 - 1.1216739095128487e-5im 7.288813177296751e-7 + 3.202184494778105e-6im; 7.701143271164553e-6 + 8.318256646653306e-6im 2.9796589616256417e-5 + 5.132823963644119e-5im … 2.174155892500359e-6 - 2.140220179959446e-6im 1.2985709278464446e-5 + 1.4546851160131249e-5im; … ; 1.1376731708114832e-5 + 7.928562181463665e-6im -1.108013303805461e-5 + 6.393102067125935e-6im … -2.3897153434350544e-5 - 8.274041264880685e-6im -1.746003677764221e-5 + 1.9057573897513354e-5im; -4.665423758703017e-6 - 6.1493009218178815e-6im -4.8743683652615856e-6 + 1.1368569604366946e-5im … -4.897049532050623e-6 - 1.1516462501639542e-5im -2.535475994899059e-5 - 3.281516753975101e-5im;;; -0.08596181425941077 + 0.10300534008878846im -1.7197276804440005e-6 + 9.423773849174549e-6im … 0.04015773823482909 + 0.1330483323136242im -6.115601267836318e-6 + 2.1504259465293336e-5im; -7.34221426282904e-6 + 7.231575239233497e-6im -4.634075843987266e-6 - 6.1931389672895765e-6im … 7.147019209428235e-6 + 1.0386106515515187e-5im -1.106178188763553e-5 + 4.889425872361432e-6im; … ; -9.07165872313309e-5 + 0.040630403839721156im 6.428445483515777e-6 + 7.364022368808702e-6im … 0.12026549954176428 + 0.04569103065207203im 8.387959120002923e-6 + 1.1429560459145655e-5im; -1.586747114925557e-5 + 2.5385293021133855e-5im -7.150419583952157e-6 - 7.340930853881688e-6im … 1.0623326083691978e-5 + 1.9235686719276643e-5im -1.1368661096906748e-5 + 4.56285363992673e-6im;;; 1.6895995654273356e-5 + 7.868023317203086e-6im 4.82562587755324e-6 - 2.1623396854583188e-5im … -3.705299310399697e-5 - 1.1677796151006458e-5im 2.5762769484422313e-6 - 2.64679966096794e-7im; 1.5093723855742266e-5 + 1.5028520942780337e-5im 2.4681594531005322e-5 + 5.9303330516006285e-5im … 1.1946592348927835e-5 + 6.651970086226968e-6im 2.5973856817217372e-5 + 2.8706769912863697e-5im; … ; 2.668888145836208e-5 + 1.7137735789671164e-5im -1.3305309462926962e-5 - 2.409676308727007e-6im … -2.9363403904106633e-5 - 3.817506422981522e-6im -2.506895628011946e-5 + 1.7597129116472848e-5im; -4.422759789006222e-6 - 7.370983314985007e-6im -1.9807318322852593e-5 + 2.0559804701363355e-5im … 2.0436456957411035e-6 - 7.903205721319112e-6im -1.532449873388544e-5 - 8.704647306275709e-6im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -62.27771586136885), converged = true, ρ = [0.09610720131657349 0.09085401337936384 … 0.07655587366850683 0.0908540133788624; 0.09085401337940975 0.08147776990985807 … 0.07647151840759982 0.08747433053340685; … ; 0.07655587366862646 0.07647151840769145 … 0.03956580495562935 0.06138424717739417; 0.09085401337888412 0.08747433053338763 … 0.06138424717738304 0.08147776990909947;;; 0.0908540133793621 0.08147776990991178 … 0.07647151840773583 0.08747433053339199; 0.08147776990980651 0.06246757364771441 … 0.07270707893258156 0.08316148815271004; … ; 0.07647151840772583 0.0727070789326671 … 0.05738308452663609 0.07121914197074825; 0.08747433053342209 0.08316148815284802 … 0.07121914197082498 0.08316148815236693;;; 0.07655587366911268 0.06138424717802948 … 0.06641329348298741 0.07647151840792629; 0.06138424717767002 0.03680319832591653 … 0.06415300528572881 0.07121914197095311; … ; 0.06641329348300573 0.06415300528602826 … 0.05747311921165691 0.06415300528559476; 0.07647151840804382 0.07121914197141324 … 0.06415300528568528 0.07270707893256224;;; … ;;; 0.06001281548251049 0.06348370462308184 … 0.029186011399440784 0.04413141881662591; 0.06348370462315428 0.05979446095483836 … 0.04476312021427859 0.05713332556587215; … ; 0.029186011399970097 0.04476312021497184 … 0.015925084145827245 0.015925084145697994; 0.044131418816784285 0.057133325565987124 … 0.015925084145521608 0.024857443207175256;;; 0.07655587366838112 0.07647151840746044 … 0.039565804954847274 0.061384247177010375; 0.07647151840754295 0.07270707893241798 … 0.05738308452568888 0.07121914197037763; … ; 0.039565804955439 0.057383084526310406 … 0.005337878765182573 0.015925084145474614; 0.061384247177175486 0.0712191419704515 … 0.015925084145232984 0.036803198325433314;;; 0.09085401337876796 0.08747433053325851 … 0.06138424717692841 0.08147776990889115; 0.08747433053335142 0.08316148815265977 … 0.07121914197027494 0.08316148815219541; … ; 0.06138424717730293 0.07121914197059329 … 0.01592508414552212 0.03680319832556843; 0.08147776990897557 0.08316148815217694 … 0.03680319832542029 0.06246757364682084;;;;], eigenvalues = Any[[-0.1621759458825604, -0.07512573394444369, -0.07512573394435709, -0.07512573394414017, -0.07512573394389863, -0.01016811405551166, -0.010168114055251483, -0.010168114054983053, -0.010168114054788712, -0.010168114054379491  …  0.2243629990124678, 0.22436299901261447, 0.22436299901268722, 0.22436299901291357, 0.22436299901307968, 0.2243629990133896, 0.22436299901351933, 0.2705989718873226, 0.27059897188761706, 0.27059897188799653]], occupation = [[2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0  …  2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0]], εF = nothing, n_iter = 4, ψ = Matrix{ComplexF64}[[0.9296325312054556 + 0.2272100650427463im 1.1314041695789148e-11 + 5.057530750762636e-12im … -7.836715117408975e-14 - 1.4078045544783937e-12im 2.0482929551503436e-12 - 1.0211449412053417e-12im; 5.754073055326274e-12 - 1.206965826168953e-12im -0.36660016137455825 - 0.1629340528327679im … 9.626789769263e-12 + 6.627422826570133e-12im 6.7565483224866325e-12 + 3.410899314661392e-13im; … ; 2.9408114710993626e-13 - 1.2412664092132323e-12im 1.8046575726060237e-12 - 4.174767709100353e-12im … -5.737026366394327e-11 - 4.513285274515262e-12im -5.520622091184624e-11 - 5.955306469630536e-11im; 1.5615434157323013e-12 + 3.780738778484346e-12im 0.14781451470815213 - 0.3323919706709948im … 6.5804920784369794e-12 + 6.771803083899437e-12im -8.079410854367863e-13 + 5.76969503464776e-12im]], stage = :finalize, algorithm = &quot;Newton&quot;)</pre><pre><code class="language-julia">scfres_newton.energies</code></pre><pre class="documenter-example-output">Energy breakdown (in Ha):
    Kinetic             25.7697876
    AtomicLocal         -18.8616201
    AtomicNonlocal      14.8540134
    Ewald               -67.1831486
    PspCorrection       -2.3569765
    Hartree             4.8508714 
    Xc                  -19.3506430

    total               -62.277715861369</pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../metallic_systems/">« Temperature and metallic systems</a><a class="docs-footer-nextpage" href="../ase/">Creating slabs with ASE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 21 March 2022 07:39">Monday 21 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
